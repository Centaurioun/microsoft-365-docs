= Deploy a connector to archive Twitter data
:ROBOTS: NOINDEX, NOFOLLOW
:audience: Admin
:author: robmazz
:description: Administrators can set up a native connector to import and archive Twitter data to Microsoft 365. After this data is imported to Microsoft 365, you can use compliance features such as legal hold, content search, and retention policies to manage the governance of your organization's Twitter data.
:experimental:
:f1.keywords: ["NOCSH"]
:manager: laurawi
:ms.author: robmazz
:ms.collection: ["tier1", "M365-security-compliance", "data-connectors"]
:ms.custom: admindeeplinkCOMPLIANCE
:ms.date:
:ms.localizationpriority: medium
:ms.service: O365-seccomp
:ms.topic: article
:search.appverid: ["MET150"]

== Deploy a connector to archive Twitter data

This article contains the step-by-step process to deploy a connector that uses the Office 365 Import service to import data from your organization's Twitter account to Microsoft 365.
For a high-level overview of this process and a list of prerequisites required to deploy a Twitter connector, see xref:archive-twitter-data-with-sample-connector.adoc[Set up a connector to archive Twitter data].

=== Step 1: Create an app in Azure Active Directory

. Go to https://portal.azure.com and sign in using the credentials of a global admin account.
+
image::../media/TCimage01.png[Sign in to Azure.]

. In the left navigation pane, click *Azure Active Directory*.
+
image::../media/TCimage02.png[Go to Azure Active Directory.]

. In the left navigation pane, click *App registrations (Preview)* and then click *New registration*.
+
image::../media/TCimage03.png[Create a new app registration.]

. Register the application.
Under *Redirect URI (optional)*, select *Web* in the application type dropdown list and then type `+https://portal.azure.com+` in the box for the URI.
+
image::../media/TCimage04.png[Type https://portal.azure.com for the redirect URI.]

. Copy the *Application (client) ID* and *Directory (tenant) ID* and save them to a text file or other safe location.
You use these IDs in later steps.
+
image::../media/TCimage05.png[Copy and save the Application Id and Directory Id.]

. Go to *Certificates & secrets for the new app* and under *Client secrets* click *New client secret*.
+
image::../media/TCimage06.png[Create a new client secret.]

. Create a new secret.
In the description box, type the secret and then choose an expiration period.
+
image::../media/TCimage08.png[Type the secret and choose expiration period.]

. Copy the value of the secret and save it to a text file or other storage location.
This is the AAD application secret that you use in later steps.
+
image::../media/TCimage09.png[Copy and save the secret.]

=== Step 2: Deploy the connector web service from GitHub to your Azure account

. Go to https://github.com/microsoft/m365-sample-twitter-connector-csharp-aspnet[this GitHub site] and click *Deploy to Azure*.
+
image::../media/FBCimage11.png[Go to the Azure home page.]

. After you click *Deploy to Azure*, you will be redirected to an Azure portal with a custom template page.
Fill in the *Basics* and *Settings* details and then click *Purchase*.
+
image::../media/FBCimage12.png[Click Create a resource and type storage account.]

 ** *Subscription:* Select your Azure subscription that you want to deploy the Twitter connector web service to.
 ** *Resource group:* Choose or create a new resource group.
A resource group is a container that holds related resources for an Azure solution.
 ** *Location:* Choose a location.
 ** *Web App Name:* Provide a unique name for the connector web app.
Th name must be between 3 and 18 characters in length.
This name is used to create the Azure app service URL;
for example, if you provide the Web app name of *twitterconnector* then the Azure app service URL  will be *twitterconnector.azurewebsites.net*.
 ** *tenantId:* The tenant ID of your Microsoft 365 organization that you copied after creating the Facebook connector app in Azure       Active Directory in Step 1.
 ** *APISecretKey:* You can type any value as the secret.
This is used to access the connector web app in Step 5.

. After the deployment is successful, the page will look similar to the following screenshot:
+
image::../media/FBCimage13.png[Click Storage and then click Storage account.]

=== Step 3: Create the Twitter app

. Go to https://developer.twitter.com, log in using the credentials for the developer account for your organization, and then click *Apps*.
+
image::../media/TCimage25-5.png[Go to https://developer.twitter.com and log in.]

. Click *Create an app*.
+
image::../media/TCimage26.png[Go to Apps page to create an app.]

. Under *App details*, add information about the application.
+
image::../media/TCimage27.png[Enter info about the app.]

. On the Twitter developer dashboard, select the app that you just created and then click *Details*.
+
image::../media/TCimage28.png[Copy and save the App Id.]

. On the *Keys and tokens* tab, under *Consumer API keys* copy both the API Key and the API secret key and save them to a text file or other storage location.
Then click *Create* to generate an access token and access token secret and copy these to a text file or other storage location.
+
image::../media/TCimage29.png[Copy and save to API secret key.]
+
Then click *Create* to generate an access token and an access token secret, and copy these to a text file or other storage location.

. Click the *Permissions* tab and configure the permissions as shown in the following screenshot:
+
image::../media/TCimage30.png[Configure permissions.]

. After you save the permission settings, click the *App details* tab, and then click menu:Edit[Edit details].
+
image::../media/TCimage31.png[Edit the app details.]

. Do the following tasks:
 ** Select the checkbox to allow the connector app to sign in to Twitter.
 ** Add the OAuth redirect Uri using the following format: *<connectorserviceuri>/Views/TwitterOAuth*, where the value of _connectorserviceuri_ is the Azure app service URL for your organization;
for example, https://twitterconnector.azurewebsites.net/Views/TwitterOAuth.

+
image::../media/TCimage32.png[Allow connector app to sign in to Twitter and add OAuth redirect Uri.]

The Twitter developer app is now ready to use.

=== Step 4: Configure the connector web app

. Go to https://<AzureAppResourceName>.azurewebsites.net (where *AzureAppResourceName* is the name of your Azure app resource that you named in Step 4).
For example, if the name is *twitterconnector*, go to https://twitterconnector.azurewebsites.net.
The home page of the app looks like the following screenshot:
+
image::../media/FBCimage41.png[Go to Azure app resource page.]

. Click *Configure* to display a sign in page.
+
image::../media/FBCimage42.png[Click Configure to display sign in page.]

. In the Tenant Id box, type or paste your tenant Id (that you obtained in Step 2).
In the password box, type or paste the APISecretKey (that you obtained in Step 2), and then click *Set Configuration Settings* to display the configuration details page.
+
image::../media/TCimage35.png[Sign in using tenant Id and API secret key.]

. Enter the following configuration settings
 ** *Twitter Api Key:* The API key for the Twitter application that you created in Step 3.
 ** *Twitter Api Secret Key:* The API secret key for the Twitter application that you created in Step 3.
 ** *Twitter Access Token:* The access token that you created in Step 3.
 ** *Twitter Access Token Secret:* The access token secret that you created in Step 3.
 ** *AAD Application ID:* The application ID for the Azure Active Directory app that you created in Step 1
 ** *AAD Application Secret:* The value for the APISecretKey secret that you created in Step 1.
. Click *Save* to save the connector settings.

=== Step 5: Set up a Twitter connector in the compliance portal

. Go to the Microsoft Purview compliance portal, and select https://go.microsoft.com/fwlink/p/?linkid=2173865[*Data connectors* page</a.]
. On the *Data connectors* page under *Twitter*, click *View*.
. On the *Twitter* page, click *Add connector*.
. On the *Terms of service* page, click *Accept*.
. On the *Add credentials for your connector app* page, enter the following information and then click *Validate connection*.
+
image::../media/TCimage38.png[Enter connector app credentials.]

 ** In the *Name* box, type a name for the connector, such as *Twitter help handle*.
 ** In the *Connector URL* box, type or paste the Azure app service URL;
for example `+https://twitterconnector.azurewebsites.net+`.
 ** In the *Password* box, type or paste the value of the APISecretKey that you created in Step 2.
 ** In the *Azure App ID* box, type or paste the value of the Azure Application App Id (also called the _client ID_) that you obtained in Step 1.

. After the connection is successfully validated, click *Next*.
. On the *Authorize Microsoft 365 to import data* page, type or paste the APISecretKey again and then click  *Login web app*.
. Click *Login with Twitter*.
. On the Twitter sign in page, sign in using the credentials for your organization's Twitter account.
+
image::../media/TCimage42.png[Sign in to Twitter account.]
+
After you sign in, the Twitter page will display the following message, "Twitter Connector Job Successfully set up."

. Click *Continue* to complete setting up the Twitter connector.
. On the *Set filters* page, you can apply a filter to initially import items that are a certain age.
Select an age, and then click *Next*.
. On the *Choose storage location* page, type the email address of Microsoft 365 mailbox that the Twitter items will be imported to, and then click *Next*.
. Click *Next* to review the connector settings and then click *Finish* to complete the connector setup.
. In the compliance center, go to the *Data connectors* page, and click the *Connectors* tab to see the progress of the import process.
