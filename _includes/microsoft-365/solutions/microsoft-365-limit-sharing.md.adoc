= Limit sharing in Microsoft 365
:audience: ITPro
:author: MikePlumleyMSFT
:description: Learn about the options to limit or disable sharing in Microsoft 365.
:f1.keywords: NOCSH
:manager: serdars
:ms.author: mikeplum
:ms.collection: ["highpri", "SPO_Content", "M365-collaboration", "m365solution-3tiersprotection", "m365solution-securecollab", "m365initiative-externalcollab"]
:ms.custom: ["admindeeplinkMAC", "admindeeplinkTEAMS", "admindeeplinkSPO"]
:ms.localizationpriority: high
:ms.service: o365-solutions
:ms.topic: article
:recommendations: false
:search.appverid: ["SPO160", "MET150"]

== Limit sharing in Microsoft 365

While you can't disable internal sharing entirely or remove the Share button from sites, there are a variety of ways that you can limit sharing in Microsoft 365 to meet the needs of your organization.

The methods of sharing files are listed in the table below.
Click the link in the *Sharing method* column for detailed information.

|===
| Sharing method | Description | Limiting options

| <<microsoft-365-group-or-team,Microsoft 365 group or team>>
| People granted access to a Microsoft Teams team or Microsoft 365 group have edit access to files in the associated SharePoint site.
| If the group or team is private, sharing invitations to join the team go to the owner for approval.
Admins can disable guest access or use sensitivity labels to prevent access by people from outside the organization.

| <<sharepoint-site,SharePoint site>>
| People can be granted Owner, Member, or Visitor access to a SharePoint site and will have that level of access to files in the site.
| Site permissions can be restricted so that only site owners can share the site.
Admins can set a site to read-only or block access entirely.

| <<sharing-with-specific-people,Sharing with specific people>>
| Site members and people with edit permissions can give direct permissions to files and folders or share them by using _Specific people_ links.
| Site permissions can be restricted so that only site owners can share files and folders.
In this case, direct access and _Specific people_ link sharing by site members goes to site owner for approval.

| <<sharepoint-guest-sharing,SharePoint and OneDrive guest sharing>>
| SharePoint site owners and members and OneDrive owners can share files and folders with people outside the organization.
| Guest sharing can be disabled for the entire organization or for individual sites.

| <<people-in-your-organization-sharing-links,_People in your organization_ sharing links>>
| SharePoint site owners and members can share files using _People in your organization_ links, which will work for anyone inside the organization.
| _People in your organization_ links can be disabled at the site level.

| <<create-sites-groups-and-teams,Create sites, groups, and teams>>
| By default, users can create new sites, groups, and teams from which they can share content.
| Admins can restrict who can create sites, groups, and teams.

| <<email,Email>>
| People with access to a file can send it to others via email.
| Admins can encrypt files by using sensitivity labels to prevent them being shared with unauthorized people.

| <<download-or-file-copy,Download or file copy>>
| People with access to a file can download or copy it and share it with others outside the scope of Microsoft 365.
| Admins can encrypt files by using sensitivity labels to prevent them being shared with unauthorized people.
|===

You can also restrict the conditions under which people access shared content.
See <<conditional-access,conditional access>> later in this article for more information.

While you can use the admin controls described in this article to limit sharing in your organization, we highly recommend that you consider using the security and compliance features available in Microsoft 365 to create a secure sharing environment.
See link:/sharepoint/deploy-file-collaboration[File collaboration in SharePoint with Microsoft 365] and xref:secure-teams-security-isolation.adoc[Configure a team with security isolation] for information.

To understand how sharing is being used in your organization, link:/sharepoint/sharing-reports[run a report on file and folder sharing].

=== Microsoft 365 group or team

If you want to limit sharing in a Microsoft 365 group or Microsoft Teams team, it's important to make the group or team private.
People inside your organization can join a public group or team anytime.
Unless the group or team is private, there's no way to limit sharing of the team or its files within the organization.

==== Guest sharing

If you want to prevent guest access in Teams, you can turn off guest sharing in the Teams admin center.

To turn off guest sharing for Teams

. In the Teams admin center, expand *Org-wide settings* > https://go.microsoft.com/fwlink/p/?linkid=2173122[*Guest access* tab].
. Turn off *Allow guest access in Teams*.
. Click *Save*.

If you want to prevent guest access in Microsoft 365 Groups, you can turn off the groups guest access settings in the Microsoft 365 admin center.

To turn off guest sharing in Microsoft 365 Groups

. In the Microsoft 365 admin center, click *Settings* > *Org Settings* > https://go.microsoft.com/fwlink/p/?linkid=2053743[*Services* tab].
. Click *Microsoft 365 Groups*.
. Clear the *Let group members outside your organization access group content* and *Let group owners add people outside your organization to groups* check boxes.
. Click *Save changes*.
+
image::../media/office-365-groups-guest-settings-off.png[Screenshot of Microsoft 365 Groups sharing settings in the Microsoft 365 admin center.]

____
[!NOTE] If you want to prevent guest sharing for a particular group or team, you can do so by using xref:per-group-guest-access.adoc[Microsoft PowerShell] or xref:../compliance/sensitivity-labels-teams-groups-sites.adoc[sensitivity labels].
____

You can limit guest sharing to users from specific domains by allowing or blocking domains in Azure Active Directory.
This will also affect guest sharing in SharePoint if you have enabled link:/sharepoint/sharepoint-azureb2b-integration-preview[SharePoint and OneDrive integration with Azure AD B2B].

To allow sharing invitations only from specified domains

. In Azure Active Directory, on the Overview page, click *Organizational relationships*.
. Click *Settings*.
. Under *Collaboration restrictions*, select *Deny invitations to the specified domains* or *Allow invitations only to the specified domains*, and then type the domains that you want to use.
. Click *Save*.
+
image::../media/azure-ad-allow-only-specified-domains.png[Screenshot of collaboration restrictions settings in Azure Active Directory.]

=== SharePoint site

You can limit SharePoint site sharing to site owners only.
This prevents site members from sharing the site.
Keep in mind that if the site is connected to a Microsoft 365 group, group members can invite others to the group and those users will have site access.

To limit site sharing to owners

. In the site, click the gear icon, and then click *Site permissions*.
. Under *Sharing settings*, click *Change sharing settings*.
. Select *Site owners and members, and people with Edit permissions can share files and folders, but only site owners can share the site*.
. Click *Save*.
+
image::../media/sharepoint-site-sharing-permissions-level-two.png[Screenshot of sharing permissions settings in a SharePoint site.]

You can prevent users who are not members of the site from requesting access by turning off access requests.

To turn off access requests

. In the site, click the gear icon, and then click *Site permissions*.
. Under *Sharing settings*, click *Change sharing settings*.
. Turn off *Allow access requests*, and then click *Save*.

You can limit site sharing to specific domains by allowing or blocking domains for the site.

To limit site sharing by domain

. In the SharePoint admin center, under *Sites*, select https://go.microsoft.com/fwlink/?linkid=2185220[*Active sites*].
. Select the site that you want to configure.
. On the *Policies* tab, under *External sharing* select *Edit*.
. Under *Advanced settings for external sharing*, select the *Limit sharing by domain*.
. Add the domains that you want to allow or block, and then select *Save*.
. Select *Save*.
+
image::../media/limit-site-sharing-by-domain.png[Screenshot of allowed domains site-level setting.]

==== Block access to a site

You can block access to a site or make a site read-only by changing the lock state of the site.
For details, see link:/sharepoint/manage-lock-status[Lock and unlock sites].

==== Permissions inheritance

While not recommended, you can use link:/sharepoint/what-is-permissions-inheritance[SharePoint permissions inheritance] to customize access levels to sites and subsites.

=== Sharing with specific people

if you want to limit the sharing of a site or its contents, you can configure the site to only allow site owners to share files, folders, and the site.
When this is configured, site members' attempts to share files or folders by using _Specific people_ links will go to the site owner for approval.

To limit site, file, and folder sharing to owners

. In the site, click the gear icon, and then click *Site permissions*.
. Under *Sharing settings*, click *Change sharing settings*.
. Select *Only site owners can share files, folders, and the site*.
. Click *Save*.
+
image::../media/sharepoint-site-only-site-owners-can-share.png[Screenshot of sharing permissions settings in a SharePoint site set to owners-only.]

=== SharePoint guest sharing

If you want to prevent sharing SharePoint or OneDrive files and folders with people outside your organization, you can turn off guest sharing for the entire organization or for an individual site.

To turn off SharePoint guest sharing for your organization

. In the SharePoint admin center, under *Policies*, select https://go.microsoft.com/fwlink/?linkid=2185222[*Sharing*].
. Under *External sharing*, drag the SharePoint slider down to *Only people in your organization*.
. Select *Save*.
+
image::../media/sharepoint-tenant-sharing-off.png[Screenshot of SharePoint organization-level sharing settings set to Anyone.]

To turn off guest sharing for a site

. In the SharePoint admin center, under *Sites*, select https://go.microsoft.com/fwlink/?linkid=2185220[*Active sites*].
. Select the site that you want to configure.
. On the *Policies* tab, under *External sharing* select *Edit*.
. Under *External sharing*, choose *Only people in your organization*, and then select *Save*.
+
image::../media/sharepoint-site-external-sharing-settings-off.png[Screenshot of SharePoint site-level sharing settings set to Only people in your organization.]

You can turn off guest sharing for an individual OneDrive by clicking the user in the Microsoft 365 admin center and selecting *Manage external sharing* on the *OneDrive* tab.

If you would like to allow sharing with people outside your organization but you want to make sure that everyone authenticates, you can disable _Anyone_ (anonymous sharing) links for the entire organization or for an individual site.

To turn off _Anyone_ links at the organization level

. In the SharePoint admin center, under *Policies*, select https://go.microsoft.com/fwlink/?linkid=2185222[*Sharing*].
. Under *External sharing*, drag the SharePoint slider down to *New and existing guests*.
. Select *Save*.
+
image::../media/sharepoint-guest-sharing-new-existing-guests.png[Screenshot of SharePoint organization-level sharing settings set to New and existing guests.]

To turn off _Anyone_ links for a site

. In the SharePoint admin center, under *Sites*, select https://go.microsoft.com/fwlink/?linkid=2185220[*Active sites*].
. Select the site that you want to configure.
. On the *Policies* tab, under *External sharing* select *Edit*.
. Under *External sharing*, choose *New and existing guests*, and then select *Save*.
+
image::../media/sharepoint-site-external-sharing-settings-new-existing-guests.png[Screenshot of SharePoint site-level sharing settings set to New and existing settings.]

=== _People in your organization_ sharing links

By default, members of a site can share files and folders with other people in your organization by using a _People in your organization_ link.
You can disable _People in your organization_ links by using PowerShell:

[,powershell]
----
Set-SPOSite -Identity <site> -DisableCompanyWideSharingLinks Disabled
----

For example:

[,powershell]
----
Set-SPOSite -Identity https://contoso.sharepoint.com -DisableCompanyWideSharingLinks Disabled
----

=== Create sites, groups, and teams

By default, users can create new sites, groups, and teams from which they may be able to share content (depending on your sharing settings).
You can restrict who can create sites, groups, and teams.
See the following references:

* link:/sharepoint/manage-site-creation[Manage site creation in SharePoint]
* xref:./manage-creation-of-groups.adoc[Manage who can create Microsoft 365 Groups]

____
[!NOTE] Restricting group creation restricts team creation.
____

=== Email

You can prevent unwanted sharing of emails by using encryption.
This prevents emails being forwarded or otherwise shared with unauthorized users.
Email encryption can be enabled by using sensitivity labels.
See xref:../compliance/encryption-sensitivity-labels.adoc[Restrict access to content by using encryption in sensitivity labels] for details.

=== Download or file copy

Users who have access to files and folders in Microsoft 365 can download files and copy them to external media.
To reduce the risk of unwanted file sharing, you can encrypt the content by using sensitivity labels.

=== Conditional access

Azure Active Directory conditional access provides options to limit or prevent sharing with people based on network location, device health, sign-in risk, and other factors.
See link:/azure/active-directory/conditional-access/overview[What is Conditional Access?].

SharePoint provides direct integration with Azure AD conditional access for both unmanaged devices and network location.
See the following references for details:

* link:/sharepoint/control-access-from-unmanaged-devices[Control access from unmanaged devices]
* link:/sharepoint/control-access-based-on-network-location[Control access to SharePoint and OneDrive data based on network location]

=== See also

xref:microsoft-365-guest-settings.adoc[Microsoft 365 guest sharing settings reference]
