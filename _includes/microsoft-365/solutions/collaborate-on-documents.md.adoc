= Collaborate with guests on a document
:audience: ITPro
:author: MikePlumleyMSFT
:description: In this article, you'll learn how to collaborate with guests on a document in SharePoint and OneDrive.
:f1.keywords: NOCSH
:manager: serdars
:ms.author: mikeplum
:ms.collection: ["highpri", "SPO_Content", "M365-collaboration", "m365solution-3tiersprotection", "m365solution-securecollab", "m365initiative-externalcollab"]
:ms.custom: ["seo-marvel-apr2020", "admindeeplinkSPO"]
:ms.localizationpriority: medium
:ms.service: o365-solutions
:ms.topic: article
:recommendations: false

== Collaborate with guests on a document

If you need to collaborate with people outside your organization on documents in SharePoint or OneDrive, you can send them a sharing-link to the document.
In this article, we'll walk through the Microsoft 365 configuration steps necessary to set up sharing-links for SharePoint and OneDrive for the needs of your organization.

=== Video demonstration

This video shows the configuration steps described in this document.</br>

____
[!VIDEO https://www.microsoft.com/videoplayer/embed/RE450Vt?autoplay=false]
____

=== Azure external collaboration settings

Sharing in Microsoft 365 is governed at its highest level by the link:/azure/active-directory/external-identities/delegate-invitations[B2B external collaboration settings in Azure Active Directory].
If guest-sharing is disabled or restricted in Azure AD, this setting overrides any sharing settings that you configure in Microsoft 365.

Check the B2B external collaboration settings to ensure that sharing with guests is not blocked.

image::../media/azure-ad-organizational-relationships-settings.png[Screenshot of Azure Active Directory Organizational Relationships Settings page.]

To set external collaboration settings

. Log in to Azure Active Directory at https://aad.portal.azure.com.
. In the left navigation pane, click *Azure Active Directory*.
. Click *External identities*.
. On the *Get started* screen, in the left navigation pane, click *External collaboration settings*.
. Ensure that either *Member users and users assigned to specific admin roles can invite guest users including guests with member permissions* or *Anyone in the organization can invite guest users including guests and non-admins* is selected.
. If you made changes, click *Save*.

Note the settings in the *Collaboration restrictions* section.
Make sure that the domains of the guests that you want to collaborate with aren't blocked.

If you work with guests from multiple organizations, you may want to restrict their ability to access directory data.
This will prevent them from seeing who else is a guest in the directory.
To do this, under *Guest user access restrictions*, select *Guest users have limited access to properties and membership of directory objects settings* or *Guest user access is restricted to properties and memberships of their own directory objects*.

=== SharePoint organization-level sharing settings

In order for people outside your organization to have access to a document in SharePoint or OneDrive, the SharePoint and OneDrive organization-level sharing settings must allow for sharing with people outside your organization.

The organization-level settings for SharePoint determine the settings that will be available for individual SharePoint sites.
Site settings cannot be more permissive than the organization-level settings.
The organization-level setting for OneDrive determines the level of sharing that will be available in users' OneDrive libraries.

For SharePoint and OneDrive, if you want to allow unauthenticated file and folder sharing, choose *Anyone*.
If you want to ensure that people outside your organization have to authenticate, choose *New and existing guests*.
_Anyone_ links is the easiest way to share: people outside your organization can open the link without authentication and are free to pass it on to others.

For SharePoint, choose the most permissive setting that will be needed by any site in your organization.

image::../media/sharepoint-organization-external-sharing-controls.png[Screenshot of SharePoint organization-level sharing settings.]

To set SharePoint organization-level sharing settings

. In the Microsoft 365 admin center, in the left navigation pane, under *Admin centers*, click *SharePoint*.
. In the SharePoint admin center, in the left navigation pane, under *Policies*, select https://go.microsoft.com/fwlink/?linkid=2185222[*Sharing*].
. Ensure that external sharing for SharePoint or OneDrive is set to *Anyone* or *New and existing guests*.
(Note that the OneDrive setting cannot be more permissive than the SharePoint setting.)
. If you made changes, select *Save*.

=== SharePoint organization-level default link settings

The default file and folder link settings determine the link option that will be shown to users by default when they share a file or folder.
Users can change the link type to one of the other options before sharing, if desired.

Keep in mind that this setting affects SharePoint sites in your organization, as well as OneDrive.

Choose a link from any of the following types which is then selected by default when users share files and folders:

* *Anyone with the link* - Choose this option if you expect to do a lot of unauthenticated file and folder sharing.
If you want to allow _Anyone_ links but are concerned about accidental unauthenticated sharing, consider one of the other options as the default.
This link type is only available if you've enabled *Anyone* sharing.
* *Only people in your organization* - Choose this option if you expect most file and folder sharing to be with people inside your organization.
* *Specific people* - Consider this option if you expect to do a lot of file and folder sharing with guests.
This type of link works with guests and requires them to authenticate.

image::../media/sharepoint-organization-files-folders-sharing-settings.png[Screenshot of SharePoint organization-level files and folders sharing settings.]

To set the SharePoint and OneDrive organization-level default link settings

. Go to https://go.microsoft.com/fwlink/?linkid=2185222[*Sharing*] in the SharePoint admin center.
. Under *File and folder links*, select the default sharing link that you want to use.
. If you made changes, click *Save*.

To set the permission for the sharing link, under *Choose the permission that's selected by default for sharing links.*

. Select *View* if you do not want unauthenticated users to make changes to the files and folders.
. Select *Edit* if you want to allow unauthenticated users to make changes to the files and folders.

Note that the above two premission-options can be applied not only for guests/external users but also for internal users.
The permission-option you choose is determined by self-discretion.

To set permissions for links that allow sharing with anyone

. Under the *These links can give these permissions:* sub-pane,
 .. From the *Files* drop-down list,
  *** Select *View and edit* if you want to allow unauthenticated users to make changes to the files.
  *** Select *View* if you do not want unauthenticated users to make changes to the files.
 .. From the *Folders* drop-down list,
  *** Select *View, edit, and upload* if you want to allow unauthenticated users to make changes to the folders.
  *** Select *View* if you do not want unauthenticated users to make changes to the folders.

=== SharePoint site-level sharing settings

If you're sharing files and folders that are in a SharePoint site, you also need to check the site-level sharing settings for that site.

image::../media/sharepoint-site-external-sharing-settings.png[Screenshot of SharePoint site external sharing settings.]

To set site-level sharing settings

. In the SharePoint admin center, in the left navigation pane, expand *Sites* and select https://go.microsoft.com/fwlink/?linkid=2185220[*Active sites*].
. Select the site on which you want to share files and folders with guests.
. Scroll right across the row (in which the selected site is present) and click anywhere in the *External sharing* column.
. From the page that pops up, click *Policies* tab.
. Under the *External sharing* pane, click *Edit*.
. Ensure that sharing is set to *Anyone* or *New and existing guests*.
. If you made changes, click *Save*.

=== Invite users

Guest-sharing settings are now configured;
so users can now share files and folders with people outside your organization.
See https://support.office.com/article/9fcc2f7d-de0c-4cec-93b0-a82024800c07[Share OneDrive files and folders] and https://support.office.com/article/1fe37332-0f9a-4719-970e-d2578da4941c[Share SharePoint files or folders] for more information.

=== See also

xref:best-practices-anonymous-sharing.adoc[Best practices for sharing files and folders with unauthenticated users]

xref:share-limit-accidental-exposure.adoc[Limit accidental exposure to files when sharing with guests]

link:/sharepoint/sharepoint-azureb2b-integration-preview[SharePoint and OneDrive integration with Azure AD B2B]
