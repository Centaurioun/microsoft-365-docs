= Advanced hunting quotas and usage parameters in Microsoft 365 Defender
:audience: ITPro
:author: schmurky
:description: Understand various quotas and usage parameters (service limits) that keep the advanced hunting service responsive
:f1.keywords: ["NOCSH"]
:keywords: advanced hunting, threat hunting, cyber threat hunting, Microsoft 365 Defender, microsoft 365, m365, search, query, telemetry, schema, kusto, CPU limit, query limit, resources, maximum results, quota, parameters, allocation
:manager: dansimp
:ms.author: maccruz
:ms.collection: m365-security-compliance
:ms.localizationpriority: medium
:ms.mktglfcycl: deploy
:ms.pagetype: security
:ms.service: microsoft-365-security
:ms.sitesec: library
:ms.subservice: m365d
:ms.topic: article
:search.appverid: met150
:search.product: eADQiWindows 10XVcnh

== Advanced hunting quotas and usage parameters

[!INCLUDE xref:../includes/microsoft-defender.adoc[Microsoft 365 Defender rebranding]]

*Applies to:*

* Microsoft 365 Defender

To keep the service performant and responsive, advanced hunting sets various quotas and usage parameters (also known as "service limits").
These quotas and parameters apply separately to queries run manually and to queries run using xref:custom-detection-rules.adoc[custom detection rules].
Customers who run multiple queries regularly should be mindful of these limits and xref:advanced-hunting-best-practices.adoc[apply optimization best practices] to minimize disruptions.

Refer to the following table to understand existing quotas and usage parameters.

|===
| Quota or parameter | Size | Refresh cycle | Description

| Data range
| 30 days
| Every query
| Each query can look up data from up to the past 30 days.

| Result set
| 10,000 rows
| Every query
| Each query can return up to 10,000 records.

| Timeout
| 10 minutes
| Every query
| Each query can run for up to 10 minutes.
If it does not complete within 10 minutes, the service displays an error.

| CPU resources
| Based on tenant size
| Every 15 minutes
| The xref:advanced-hunting-errors.adoc[portal displays an error] whenever a query runs and the tenant has consumed over 10% of allocated resources.
Queries are blocked if the tenant has reached 100% until after the next 15-minute cycle.
|===

____
[!NOTE]  A separate set of quotas and parameters apply to advanced hunting queries performed through the API.
xref:./api-advanced-hunting.adoc[Read about advanced hunting APIs]
____

=== Related topics

* xref:advanced-hunting-best-practices.adoc[Advanced hunting best practices]
* xref:advanced-hunting-errors.adoc[Handle advanced hunting errors]
* xref:advanced-hunting-overview.adoc[Advanced hunting overview]
* xref:custom-detections-overview.adoc[Custom detections overview]
