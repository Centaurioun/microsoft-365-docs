= DeviceFromIP() function in advanced hunting for Microsoft 365 Defender
:audience: ITPro
:author: schmurky
:description: Learn how to use the DeviceFromIP() function to get the devices that have been assigned a specific IP address
:f1.keywords: ["NOCSH"]
:keywords: advanced hunting, threat hunting, cyber threat hunting, Microsoft 365 Defender, microsoft 365, m365, search, query, telemetry, schema reference, kusto, device, devicefromIP, function, enrichment
:manager: dansimp
:ms.author: maccruz
:ms.collection: m365-security-compliance
:ms.localizationpriority: medium
:ms.mktglfcycl: deploy
:ms.pagetype: security
:ms.service: microsoft-365-security
:ms.sitesec: library
:ms.subservice: m365d
:ms.topic: article
:search.appverid: met150
:search.product: eADQiWindows 10XVcnh

== DeviceFromIP()

[!INCLUDE xref:../includes/microsoft-defender.adoc[Microsoft 365 Defender rebranding]]

*Applies to:*

* Microsoft 365 Defender

[!INCLUDE xref:../includes/prerelease.adoc[Prerelease information]]

Use the `DeviceFromIP()` function in your xref:advanced-hunting-overview.adoc[advanced hunting] queries to quickly obtain the list of devices that have been assigned to a certain IP address at a given point in time.

This function returns a table with the following columns:

|===
| Column | Data type | Description

| `IP`
| `string`
| IP address

| `DeviceId`
| `string`
| Unique identifier for the device in the service
|===

=== Syntax

[,kusto]
----
invoke DeviceFromIP()
----

=== Arguments

This function is invoked as part of a query.

* *x*--The first parameter is typically already a column in the query.
In this case, it is the column named `IP`, the IP address for which you want to see a list of devices that have been assigned to it.
It should be a local IP address.
External IP addresses are not supported.
* *y*--A second optional parameter is the `Timestamp`, which instructs the function to obtain the most recent assigned devices from a specific time.
If not specified, the function returns the latest available records.

=== Example

==== Get the latest devices that have been assigned specific IP addresses

[,kusto]
----
DeviceNetworkEvents
| limit 100
| project IP = LocalIP
| invoke DeviceFromIP()
----

=== Related topics

* xref:advanced-hunting-overview.adoc[Advanced hunting overview]
* xref:advanced-hunting-query-language.adoc[Learn the query language]
* xref:advanced-hunting-schema-tables.adoc[Understand the schema]
