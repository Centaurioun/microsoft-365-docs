= Supported data types and filters in guided mode for hunting in Microsoft 365 Defender
:audience: ITPro
:author: schmurky
:description: Refine your query by using the different guided mode capabilities in advanced hunting in Microsoft 365 Defender.
:f1.keywords: ["NOCSH"]
:keywords: guided mode, advanced hunting, threat hunting, cyber threat hunting, Microsoft 365 Defender, microsoft 365, m365, search, query, telemetry, custom detections, schema, kusto
:manager: dansimp
:ms.author: maccruz
:ms.collection: ["M365-security-compliance", "m365initiative-m365-defender"]
:ms.localizationpriority: medium
:ms.mktglfcycl: deploy
:ms.pagetype: security
:ms.service: microsoft-365-security
:ms.sitesec: library
:ms.subservice: m365d
:ms.topic: conceptual
:search.appverid: met150
:search.product: eADQiWindows 10XVcnh

== Refine your query in guided mode

[!INCLUDE xref:../includes/microsoft-defender.adoc[Microsoft 365 Defender rebranding]]

*Applies to:*

* Microsoft 365 Defender

____
[!IMPORTANT] Some information relates to prereleased product which may be substantially modified before it's commercially released.
Microsoft makes no warranties, express or implied, with respect to the information provided here.

=== Use different data types
____

Advanced hunting in guided mode supports several data types that you can use to fine-tune your query.

* Numbers + image:../../media/guided-hunting/data-numbers.png[Screenshot of numbers as third condition]
* Strings + image:../../media/guided-hunting/data-strings.png[Screenshot of strings as third condition]
+
In the free text box, type the value and press *Enter* to add it.
Note that the delimiter between values is *Enter*.
+
+
image::../../media/guided-hunting/data-strings-2.png[Screenshot showing different conditions you can use]

* Boolean + image:../../media/guided-hunting/boolean.png[Screenshot of Boolean values as third condition]
* Datetime + image:../../media/guided-hunting/data-datetime.png[Screenshot of datetime values as third condition]
* Closed list - You don't need to remember the exact value you are looking for.
You can easily choose from a suggested closed list that supports multi-selection.
+ image:../../media/guided-hunting/data-closed.png[Screenshot of a closed list used as third condition]

=== Use subgroups

You can create groups of conditions by clicking *Add subgroup*:

image::../../media/guided-hunting/subgroup-1.png[Screenshot highlighting Add subgroup button]

image::../../media/guided-hunting/subgroup-2.png[Screenshot showing use of subgroups]

=== Use smart auto-complete for search

Smart auto-complete for searching devices and user accounts is supported.
You don't need to remember the device ID, full device name, or user account name.
You can start typing the first few characters of the device or user you are looking for and a suggested list appears from which you can choose what you need:

image::../../media/guided-hunting/smart-auto.png[Screenshot showing smart auto-complete support]

=== Use `EventType`

You can even look for specific event types like all failed logons, file modification events, or successful network connections by using the *EventType* filter in any section where it is applicable.

For instance, if you want to add a condition that looks for registry value deletions, you can go to the *Registry Events* section and select *EventType*.

image::../../media/guided-hunting/hunt-specific-events-1.png[Screenshot of various EventTypes]

Selecting EventType under Registry Events allows you to choose from different registry events, including the one you're hunting for, *RegistryValueDeleted*.

image::../../media/guided-hunting/hunt-specific-events-2.png[Screenshot of EventType RegistryValueDeleted]

____
[!NOTE]  `EventType` is the equivalent of `ActionType` in the data schema, which users of advanced mode might be more familiar with.
____

=== Test your query with a smaller sample size

If you're still working on your query and would like to see its performance and some sample results quickly, adjust the number of records to return by picking a smaller set through the *Sample size* dropdown menu.

image::../../media/guided-hunting/smaller-sample.png[Screenshot of sample size dropdown menu]

The sample size is set to 10,000 results by default.
This is the maximum number of records that can be returned in hunting.
However, we highly recommend lowering the sample size to 10 or 100 to quickly test your query as doing so consumes less resources while you are still working on improving the query.

Then, once you finalize your query and are ready to use it to get all the relevant results for your hunting activity, make sure that the sample size is set to 10k, the maximum.

=== Switch to advanced mode after building a query

You can click on *Edit in KQL* to view the KQL query generated by your selected conditions.
Editing in KQL opens a new tab in advanced mode, with the corresponding KQL query:

image::../../media/guided-hunting/switch-to-advanced.png[Screenshot highlighting Edit in KQL button]

image::../../media/guided-hunting/switch-to-advanced-2.png[Screenshot showing same query from guided to advanced]

In the above example, the selected view is All, therefore you can see that the KQL query searches all tables that have file properties of name and SHA256, and in all the relevant columns covering these properties.

If you change the view to *Emails & collaboration*, the query is narrowed down to:

image::../../media/guided-hunting/switch-to-advanced-3.png[Screenshot showing same query from guided to advanced but with limited domain]

=== See also

* xref:advanced-hunting-limits.adoc[Advanced hunting quotas and usage parameters]
* xref:advanced-hunting-extend-data.adoc[Extend advanced hunting coverage with the right settings]
