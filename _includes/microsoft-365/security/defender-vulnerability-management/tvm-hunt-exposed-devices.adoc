= 
dansimp
:keywords: Microsoft Defender for Endpoint-tvm scenarios, Microsoft
Defender for Endpoint, tvm, tvm scenarios, reduce threat & vulnerability
exposure, reduce threat and vulnerability, improve security
configuration, increase Microsoft Secure Score for Devices, increase
threat & vulnerability Microsoft Secure Score for Devices, Microsoft
Secure Score for Devices, exposure score, security controls,Microsoft
Defender Vulnerability Management, mdvm

== Hunt for exposed devices

{empty}[!INCLUDE link:../../includes/microsoft-defender.md[Microsoft 365
Defender rebranding]]

*Applies to:*

* https://go.microsoft.com/fwlink/?linkid=2154037[Microsoft Defender for
Endpoint Plan 2]
* link:index.yml[Microsoft Defender Vulnerability Management]
* https://go.microsoft.com/fwlink/?linkid=2118804[Microsoft 365
Defender]

{empty}[!includelink:../../includes/prerelease.md[Prerelease
information]]

____
[!Note] Want to experience Microsoft Defender Vulnerability Management?
Learn more about how you can sign up to the
link:../defender-vulnerability-management/get-defender-vulnerability-management.md[Microsoft
Defender Vulnerability Management public preview trial].
____

=== Use advanced hunting to find devices with vulnerabilities

Advanced hunting is a query-based threat-hunting tool that lets you
explore up to 30 days of raw data. You can proactively inspect events in
your network to locate threat indicators and entities. The flexible
access to data enables unconstrained hunting for both known and
potential threats.
link:../defender-endpoint/advanced-hunting-overview.md[Learn more about
advanced hunting]

==== Schema tables

* link:../defender/advanced-hunting-devicetvmsoftwareinventory-table.md[DeviceTvmSoftwareInventory]
- Inventory of software installed on devices, including their version
information and end-of-support status.
* link:../defender/advanced-hunting-devicetvmsoftwarevulnerabilities-table.md[DeviceTvmSoftwareVulnerabilities]
- Software vulnerabilities found on devices and the list of available
security updates that address each vulnerability.
* link:../defender/advanced-hunting-devicetvmsoftwarevulnerabilitieskb-table.md[DeviceTvmSoftwareVulnerabilitiesKB]
- Knowledge base of publicly disclosed vulnerabilities, including
whether exploit code is publicly available.
* link:../defender/advanced-hunting-devicetvmsecureconfigurationassessment-table.md[DeviceTvmSecureConfigurationAssessment]
- Defender Vulnerability Management assessment events, indicating the
status of various security configurations on devices.
* link:../defender/advanced-hunting-devicetvmsecureconfigurationassessmentkb-table.md[DeviceTvmSecureConfigurationAssessmentKB]
- Knowledge base of various security configurations used by Defender
Vulnerability Management to assess devices; includes mappings to various
standards and benchmarks
* link:../defender/advanced-hunting-devicetvminfogathering-table.md[DeviceTvmInfoGathering]
- Assessment events including the status of various configurations and
attack surface area states of devices
* link:../defender/advanced-hunting-devicetvminfogatheringkb-table.md[DeviceTvmInfoGatheringKB]
- List of various configuration and attack surface area assessments used
by Defender Vulnerability Management information gathering to assess
devices

=== Check which devices are involved in high severity alerts

[arabic]
. Go to *Hunting* > *Advanced hunting* from the left-hand navigation
pane of the Microsoft 365 Defender portal.
. Scroll through advanced hunting schemas to familiarize yourself with
the column names.
. Enter the following queries:
+
[source,kusto]
----
// Search for devices with High active alerts or Critical CVE public exploit
let DeviceWithHighAlerts = AlertInfo
| where Severity == "High"
| project Timestamp, AlertId, Title, ServiceSource, Severity
| join kind=inner (AlertEvidence | where EntityType == "Machine" | project AlertId, DeviceId, DeviceName) on AlertId
| summarize HighSevAlerts = dcount(AlertId) by DeviceId;
let DeviceWithCriticalCve = DeviceTvmSoftwareVulnerabilities
| join kind=inner(DeviceTvmSoftwareVulnerabilitiesKB) on CveId
| where IsExploitAvailable == 1 and CvssScore >= 7
| summarize NumOfVulnerabilities=dcount(CveId),
DeviceName=any(DeviceName) by DeviceId;
DeviceWithCriticalCve
| join kind=inner DeviceWithHighAlerts on DeviceId
| project DeviceId, DeviceName, NumOfVulnerabilities, HighSevAlerts
----

=== Related topics

* link:tvm-security-recommendation.md[Security recommendations]
* link:../defender-endpoint/user-roles.md#create-roles-and-assign-the-role-to-an-azure-active-directory-group[Configure
data access for Defender Vulnerability Management roles]
* link:/windows/security/threat-protection/microsoft-defender-atp/advanced-hunting-overview[Advanced
hunting overview]
* link:/microsoft-365/security/defender-endpoint/advanced-hunting-schema-reference[All
advanced hunting tables]
