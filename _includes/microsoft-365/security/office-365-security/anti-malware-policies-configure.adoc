= 
chrisda

== Configure anti-malware policies in EOP

{empty}[!INCLUDE link:../includes/mdo-trial-banner.md[MDO Trial banner]]

*Applies to* - link:eop-about.md[Exchange Online Protection] -
link:defender-for-office-365.md[Microsoft Defender for Office 365 plan 1
and plan 2] - link:../defender/microsoft-365-defender.md[Microsoft 365
Defender]

In Microsoft 365 organizations with mailboxes in Exchange Online or
standalone Exchange Online Protection (EOP) organizations without
Exchange Online mailboxes, email messages are automatically protected
against malware by EOP. EOP uses anti-malware policies for malware
protection settings. For more information, see
link:anti-malware-protection-about.md[Anti-malware protection].

Admins can view, edit, and configure (but not delete) the default
anti-malware policy to meet the needs of their organizations. For
greater granularity, you can also create custom anti-malware policies
that apply to specific users, groups, or domains in your organization.
Custom policies always take precedence over the default policy, but you
can change the priority (running order) of your custom policies.

You can configure anti-malware policies in the Microsoft 365 Defender
portal or in PowerShell (Exchange Online PowerShell for Microsoft 365
organizations with mailboxes in Exchange Online; standalone EOP
PowerShell for organizations without Exchange Online mailboxes).

=== What do you need to know before you begin?

* You open the Microsoft 365 Defender portal at
https://security.microsoft.com. To go directly to the *Anti-malware*
page, use https://security.microsoft.com/antimalwarev2.
* To connect to Exchange Online PowerShell, see
link:/powershell/exchange/connect-to-exchange-online-powershell[Connect
to Exchange Online PowerShell]. To connect to standalone EOP PowerShell,
see
link:/powershell/exchange/connect-to-exchange-online-protection-powershell[Connect
to Exchange Online Protection PowerShell].
* You need to be assigned permissions in *Exchange Online* before you
can do the procedures in this article:
** To add, modify, and delete anti-malware policies, you need to be a
member of the *Organization Management* or *Security Administrator* role
groups.
** For read-only access to anti-malware policies, you need to be a
member of the *Global Reader* or *Security Reader* role groups.
+
For more information, see
link:/exchange/permissions-exo/permissions-exo[Permissions in Exchange
Online].
+
*Notes*:
** Adding users to the corresponding Azure Active Directory role in the
Microsoft 365 admin center gives users the required permissions _and_
permissions for other features in Microsoft 365. For more information,
see link:../../admin/add-users/about-admin-roles.md[About admin roles].
** The *View-Only Organization Management* role group in
link:/Exchange/permissions-exo/permissions-exo#role-groups[Exchange
Online] also gives read-only access to the feature.
* For our recommended settings for anti-malware policies, see
link:recommended-settings-for-eop-and-office365.md#eop-anti-malware-policy-settings[EOP
anti-malware policy settings].

=== Use the Microsoft 365 Defender portal to create anti-malware policies

Creating a custom anti-malware policy in the Microsoft 365 Defender
portal creates the malware filter rule and the associated malware filter
policy at the same time using the same name for both.

[arabic]
. In the Microsoft 365 Defender portal at
https://security.microsoft.com, go to *Email & Collaboration* >
*Policies & Rules* > *Threat policies* > *Anti-Malware* in the
*Policies* section. To go directly to the *Anti-malware* page, use
https://security.microsoft.com/antimalwarev2.
. On the *Anti-malware* page, click
image:../../media/m365-cc-sc-create-icon.png[Create icon.] *Create*.
. The policy wizard opens. On the *Name your policy* page, configure
these settings:
* *Name*: Enter a unique, descriptive name for the policy.
* *Description*: Enter an optional description for the policy.
+
When you’re finished, click *Next*.
. On the *Users and domains* page, identify the internal recipients that
the policy applies to (recipient conditions):
* *Users*: The specified mailboxes, mail users, or mail contacts.
* *Groups*:
** Members of the specified distribution groups or mail-enabled security
groups (dynamic distribution groups are not supported).
** The specified Microsoft 365 Groups.
* *Domains*: All recipients in the specified
link:/exchange/mail-flow-best-practices/manage-accepted-domains/manage-accepted-domains[accepted
domains] in your organization.
+
Click in the appropriate box, start typing a value, and select the value
that you want from the results. Repeat this process as many times as
necessary. To remove an existing value, click remove
image:../../media/m365-cc-sc-remove-selection-icon.png[Remove icon.]
next to the value.
+
For users or groups, you can use most identifiers (name, display name,
alias, email address, account name, etc.), but the corresponding display
name is shown in the results. For users, enter an asterisk (*) by itself
to see all available values.
+
Multiple values in the same condition use OR logic (for example,
_<recipient1>_ or _<recipient2>_). Different conditions use AND logic
(for example, _<recipient1>_ and _<member of group 1>_).
* *Exclude these users, groups, and domains*: To add exceptions for the
internal recipients that the policy applies to (recipient exceptions),
select this option and configure the exceptions. The settings and
behavior are exactly like the conditions.
+
____
[!IMPORTANT] Multiple different types of conditions or exceptions are
not additive; they’re inclusive. The policy is applied _only_ to those
recipients that match _all_ of the specified recipient filters. For
example, you configure a recipient filter condition in the policy with
the following values:

* Users: romain@contoso.com
* Groups: Executives

The policy is applied to romain@contoso.com _only_ if he’s also a member
of the Executives group. If he’s not a member of the group, then the
policy is not applied to him.

Likewise, if you use the same recipient filter as an exception to the
policy, the policy is not applied to romain@contoso.com _only_ if he’s
also a member of the Executives group. If he’s not a member of the
group, then the policy still applies to him.
____
+
When you’re finished, click *Next*.
. On the *Protection settings* page, configure the following settings:
* *Enable the common attachments filter*: If you select this option,
messages with the specified attachments are treated as malware and are
automatically quarantined. You can modify the list by clicking
*Customize file types* and selecting or deselecting values in the list.
+
For the default and available values, see
link:anti-malware-protection-about.md#anti-malware-policies[Anti-malware
policies].
+
*When these types are found*: Select one of the following values:
** *Reject the message with a non-delivery report (NDR)* (this is the
default value)
** *Quarantine the message*
* *Enable zero-hour auto purge for malware*: If you select this option,
ZAP quarantines malware messages that have already been delivered. For
more information, see link:zero-hour-auto-purge.md[Zero-hour auto purge
(ZAP) in Exchange Online].
* *Quarantine policy*: Select the quarantine policy that applies to
messages that are quarantined as malware. Quarantine policies define
what users are able to do to quarantined messages, and whether users
receive quarantine notifications. For more information, see
link:quarantine-policies.md[Quarantine policies].
+
A blank value means the default quarantine policy is used
(AdminOnlyAccessPolicy for malware detections). When you later edit the
anti-malware policy or view the settings, the default quarantine policy
name is shown. For more information about default quarantine policies
that are used for supported protection filtering verdicts, see
link:quarantine-policies.md#step-2-assign-a-quarantine-policy-to-supported-features[this
table].
+
____
[!NOTE] The quarantine policy determines whether recipients receive
email notifications for messages that were quarantined as malware.
Quarantine notifications are disabled in the AdminOnlyAccessPolicy, so
you’ll need to create and assign a custom quarantine policy where
notifications are turned on. For more information, see
link:quarantine-policies.md[Quarantine policies].

Users can’t release their own messages that were quarantined as malware.
At best, admins can configure the quarantine policy so users can request
the release of their quarantined malware messages.
____
* *Admin notifications*: Select none, one, or both of the following
options:
** *Notify an admin about undelivered messages from internal senders*:
If you select this option, enter a recipient email address in the *Admin
email address* box that appears.
** *Notify an admin about undelivered messages from external senders*:
If you select this option, enter a recipient email address in the *Admin
email address* box that appears.
+
____
[!NOTE] Admin notifications are sent only for _attachments_ that are
classified as malware.
____
* *Customize notifications*: Use the settings in this section to
customize the message properties that are used for admin notifications.
** *Use customized notification text*: If you select this option, use
the *From name* and *From address* boxes to specify the sender’s name
and email address for admin notification messages.
** *Customize notifications for messages from internal senders*: If you
previously selected *Notify an admin about undelivered messages from
internal senders*, use the *Subject* and *Message* boxes to specify the
subject and message body of admin notification messages.
** *Customize notifications for messages from external senders*: If you
previously selected *Notify an admin about undelivered messages from
external senders*, you need to use the *Subject* and *Message* boxes to
specify the subject and message body of admin notification messages.
+
When you’re finished, click *Next*.
. On the *Review* page, review your settings. You can select *Edit* in
each section to modify the settings within the section. Or you can click
*Back* or select the specific page in the wizard.
+
When you’re finished, click *Submit*.
. On the confirmation page that appears, click *Done*.

=== Use the Microsoft 365 Defender portal to view anti-malware policies

[arabic]
. In the Microsoft 365 Defender portal at
https://security.microsoft.com, go to *Email & Collaboration* >
*Policies & Rules* > *Threat policies* > *Anti-Malware* in the
*Policies* section. To go directly to the *Anti-malware* page, use
https://security.microsoft.com/antimalwarev2.
. On the *Anti-malware* page, the following properties are displayed in
the list of anti-malware policies:
* *Name*
* *Status*
* *Priority*
. When you select a policy by clicking on the name, the policy settings
are displayed in a flyout.

=== Use the Microsoft 365 Defender portal to modify anti-malware policies

[arabic]
. In the Microsoft 365 Defender portal at
https://security.microsoft.com, go to *Email & Collaboration* >
*Policies & Rules* > *Threat policies* > *Anti-Malware* in the
*Policies* section. To go directly to the *Anti-malware* page, use
https://security.microsoft.com/antimalwarev2.
. On the *Anti-malware* page, select a policy from the list by clicking
on the name.
. In the policy details flyout that appears, select *Edit* in each
section to modify the settings within the section. For more information
about the settings, see the previous
link:#use-the-microsoft-365-defender-portal-to-create-anti-malware-policies[Use
the Microsoft 365 Defender portal to create anti-malware policies]
section in this article.
+
For the default anti-malware policy, the *Users, groups, and domains*
section isn’t available (the policy applies to everyone), and you can’t
rename the policy.

To enable or disable a policy or set the policy priority order, see the
following sections.

==== Enable or disable custom anti-malware policies

You can’t disable the default anti-malware policy.

[arabic]
. In the Microsoft 365 Defender portal at
https://security.microsoft.com, go to *Email & Collaboration* >
*Policies & Rules* > *Threat policies* > *Anti-Malware* in the
*Policies* section. To go directly to the *Anti-malware* page, use
https://security.microsoft.com/antimalwarev2.
. On the *Anti-malware* page, select a custom policy from the list by
clicking on the name.
. At the top of the policy details flyout that appears, you’ll see one
of the following values:
* *Policy off*: To turn on the policy, click
image:../../media/m365-cc-sc-turn-on-off-icon.png[Turn on icon.] *Turn
on* .
* *Policy on*: To turn off the policy, click
image:../../media/m365-cc-sc-turn-on-off-icon.png[Turn off icon.] *Turn
off*.
. In the confirmation dialog that appears, click *Turn on* or *Turn
off*.
. Click *Close* in the policy details flyout.

Back on the main policy page, the *Status* value of the policy will be
*On* or *Off*.

==== Set the priority of custom anti-malware policies

By default, anti-malware policies are given a priority that’s based on
the order they were created in (newer policies are lower priority than
older policies). A lower priority number indicates a higher priority for
the policy (0 is the highest), and policies are processed in priority
order (higher priority policies are processed before lower priority
policies). No two policies can have the same priority, and policy
processing stops after the first policy is applied.

To change the priority of a policy, you click *Increase priority* or
*Decrease priority* in the properties of the policy (you can’t directly
modify the *Priority* number in the Microsoft 365 Defender portal).
Changing the priority of a policy only makes sense if you have multiple
policies.

*Notes*:

* In the Microsoft 365 Defender portal, you can only change the priority
of the anti-malware policy after you create it. In PowerShell, you can
override the default priority when you create the malware filter rule
(which can affect the priority of existing rules).
* Anti-malware policies are processed in the order that they’re
displayed (the first policy has the *Priority* value 0). The default
anti-malware policy has the priority value *Lowest*, and you can’t
change it.

[arabic]
. In the Microsoft 365 Defender portal at
https://security.microsoft.com, go to *Email & Collaboration* >
*Policies & Rules* > *Threat policies* > *Anti-Malware* in the
*Policies* section. To go directly to the *Anti-malware* page, use
https://security.microsoft.com/antimalwarev2.
. On the *Anti-malware* page, select a custom policy from the list by
clicking on the name.
. At the top of the policy details flyout that appears, you’ll see
*Increase priority* or *Decrease priority* based on the current priority
value and the number of custom policies:
* The policy with the *Priority* value *0* has only the *Decrease
priority* option available.
* The policy with the lowest *Priority* value (for example, *3*) has
only the *Increase priority* option available.
* If you have three or more policies, the policies between the highest
and lowest priority values have both the *Increase priority* and
*Decrease priority* options available.
+
Click image:../../media/m365-cc-sc-increase-icon.png[Increase priority
icon.] *Increase priority* or
image:../../media/m365-cc-sc-decrease-icon.png[Decrease priority icon]
*Decrease priority* to change the *Priority* value.
. When you’re finished, click *Close* in the policy details flyout.

=== Use the Microsoft 365 Defender portal to remove custom anti-malware policies

When you use the Microsoft 365 Defender portal to remove a custom
anti-malware policy, the malware filter rule and the corresponding
malware filter policy are both deleted. You can’t remove the default
anti-malware policy.

[arabic]
. In the Microsoft 365 Defender portal at
https://security.microsoft.com, go to *Email & Collaboration* >
*Policies & Rules* > *Threat policies* > *Anti-Malware* in the
*Policies* section. To go directly to the *Anti-malware* page, use
https://security.microsoft.com/antimalwarev2.
. On the *Anti-malware page*, select a custom policy from the list by
clicking on the name.
. At the top of the policy details flyout that appears, click
image:../../media/m365-cc-sc-more-actions-icon.png[More actions icon.]
*More actions* > image:../../media/m365-cc-sc-delete-icon.png[Delete
policy icon] *Delete policy*.
. In the confirmation dialog that appears, click *Yes*.

=== Use Exchange Online PowerShell or standalone EOP PowerShell to configure anti-malware policies

For more information about anti-spam policies in PowerShell, see
link:anti-malware-protection-about.md#anti-malware-policies-in-the-microsoft-365-defender-portal-vs-powershell[Anti-malware
policies in the Microsoft 365 Defender portal vs PowerShell].

==== Use PowerShell to create anti-malware policies

Creating an anti-malware policy in PowerShell is a two-step process:

[arabic]
. Create the malware filter policy.
. Create the malware filter rule that specifies the malware filter
policy that the rule applies to.

*Notes*:

* You can create a new malware filter rule and assign an existing,
unassociated malware filter policy to it. A malware filter rule can’t be
associated with more than one malware filter policy.
* There are two settings that you can configure on new anti-malware
policies in PowerShell that aren’t available in the Microsoft 365
Defender portal until after you create the policy:
** Create the new policy as disabled (_Enabled_ `$false` on the
*New-MalwareFilterRule* cmdlet).
** Set the priority of the policy during creation (_Priority_
_<Number>_) on the *New-MalwareFilterRule* cmdlet).
* A new malware filter policy that you create in PowerShell isn’t
visible in the Microsoft 365 Defender portal until you assign the policy
to a malware filter rule.

===== Step 1: Use PowerShell to create a malware filter policy

To create a malware filter policy, use this syntax:

[source,powershell]
----
New-MalwareFilterPolicy -Name "<PolicyName>" [-AdminDisplayName "<OptionalComments>"] [-CustomNotifications <$true | $false>] [<Inbound notification options>] [<Outbound notification options>] [-QuarantineTag <QuarantineTagName>]
----

This example creates a new malware filter policy named Contoso Malware
Filter Policy with these settings:

* Notify admin@contoso.com when malware is detected in a message from an
internal sender.
* The default link:quarantine-policies.md[quarantine policy] for malware
detections is used (we aren’t using the _QuarantineTag_ parameter).

[source,powershell]
----
New-MalwareFilterPolicy -Name "Contoso Malware Filter Policy" -EnableInternalSenderAdminNotifications $true -InternalSenderAdminAddress admin@contoso.com
----

For detailed syntax and parameter information, see
link:/powershell/module/exchange/new-malwarefilterpolicy[New-MalwareFilterPolicy].

===== Step 2: Use PowerShell to create a malware filter rule

To create a malware filter rule, use this syntax:

[source,powershell]
----
New-MalwareFilterRule -Name "<RuleName>" -MalwareFilterPolicy "<PolicyName>" <Recipient filters> [<Recipient filter exceptions>] [-Comments "<OptionalComments>"]
----

This example creates a new malware filter rule named Contoso Recipients
with these settings:

* The malware filter policy named Contoso Malware Filter Policy is
associated with the rule.
* The rule applies to recipients in the contoso.com domain.

[source,powershell]
----
New-MalwareFilterRule -Name "Contoso Recipients" -MalwareFilterPolicy "Contoso Malware Filter Policy" -RecipientDomainIs contoso.com
----

For detailed syntax and parameter information, see
link:/powershell/module/exchange/new-malwarefilterrule[New-MalwareFilterRule].

==== Use PowerShell to view malware filter policies

To return a summary list of all malware filter policies, run this
command:

[source,powershell]
----
Get-MalwareFilterPolicy
----

To return detailed information about a specific malware filter policy,
use this syntax:

[source,powershell]
----
Get-MalwareFilterPolicy -Identity "<PolicyName>" | Format-List [<Specific properties to view>]
----

This example returns all the property values for the malware filter
policy named Executives.

[source,powershell]
----
Get-MalwareFilterPolicy -Identity "Executives" | Format-List
----

This example returns only the specified properties for the same policy.

[source,powershell]
----
Get-MalwareFilterPolicy -Identity "Executives" | Format-List Action,AdminDisplayName,CustomNotifications,Enable*Notifications
----

For detailed syntax and parameter information, see
link:/powershell/module/exchange/get-malwarefilterpolicy[Get-MalwareFilterPolicy].

==== Use PowerShell to view malware filter rules

To return a summary list of all malware filter rules, run this command:

[source,powershell]
----
Get-MalwareFilterRule
----

To filter the list by enabled or disabled rules, run the following
commands:

[source,powershell]
----
Get-MalwareFilterRule -State Disabled
----

[source,powershell]
----
Get-MalwareFilterRule -State Enabled
----

To return detailed information about a specific malware filter rule, use
this syntax:

[source,powershell]
----
Get-MalwareFilterRule -Identity "<RuleName>" | Format-List [<Specific properties to view>]
----

This example returns all the property values for the malware filter rule
named Executives.

[source,powershell]
----
Get-MalwareFilterRule -Identity "Executives" | Format-List
----

This example returns only the specified properties for the same rule.

[source,powershell]
----
Get-MalwareFilterRule -Identity "Executives" | Format-List Name,Priority,State,MalwareFilterPolicy,*Is,*SentTo,*MemberOf
----

For detailed syntax and parameter information, see
link:/powershell/module/exchange/get-malwarefilterrule[Get-MalwareFilterRule].

==== Use PowerShell to modify malware filter policies

Other than the following items, the same settings are available when you
modify a malware filter policy in PowerShell as when you create the
policy as described in the
link:#step-1-use-powershell-to-create-a-malware-filter-policy[Step 1:
Use PowerShell to create a malware filter policy] section earlier in
this article.

* The _MakeDefault_ switch that turns the specified policy into the
default policy (applied to everyone, unmodifiable *Lowest* priority, and
you can’t delete it) is only available when you modify a malware filter
policy in PowerShell.
* You can’t rename a malware filter policy (the
*Set-MalwareFilterPolicy* cmdlet has no _Name_ parameter). When you
rename an anti-malware policy in the Microsoft 365 Defender portal,
you’re only renaming the malware filter _rule_.

To modify a malware filter policy, use this syntax:

[source,powershell]
----
Set-MalwareFilterPolicy -Identity "<PolicyName>" <Settings>
----

For detailed syntax and parameter information, see
link:/powershell/module/exchange/set-malwarefilterpolicy[Set-MalwareFilterPolicy].

____
[!NOTE] For detailed instructions to specify the
link:quarantine-policies.md[quarantine policy] to use in a malware
filter policy, see
link:quarantine-policies.md#anti-malware-policies-in-powershell[Use
PowerShell to specify the quarantine policy in anti-malware policies].
____

==== Use PowerShell to modify malware filter rules

The only setting that isn’t available when you modify a malware filter
rule in PowerShell is the _Enabled_ parameter that allows you to create
a disabled rule. To enable or disable existing malware filter rules, see
the next section.

Otherwise, no additional settings are available when you modify a
malware filter rule in PowerShell. The same settings are available when
you create a rule as described in the
link:#step-2-use-powershell-to-create-a-malware-filter-rule[Step 2: Use
PowerShell to create a malware filter rule] section earlier in this
article.

To modify a malware filter rule, use this syntax:

[source,powershell]
----
Set-MalwareFilterRule -Identity "<RuleName>" <Settings>
----

For detailed syntax and parameter information, see
link:/powershell/module/exchange/set-malwarefilterrule[Set-MalwareFilterRule].

==== Use PowerShell to enable or disable malware filter rules

Enabling or disabling a malware filter rule in PowerShell enables or
disables the whole anti-malware policy (the malware filter rule and the
assigned malware filter policy). You can’t enable or disable the default
anti-malware policy (it’s always applied to all recipients).

To enable or disable a malware filter rule in PowerShell, use this
syntax:

[source,powershell]
----
<Enable-MalwareFilterRule | Disable-MalwareFilterRule> -Identity "<RuleName>"
----

This example disables the malware filter rule named Marketing
Department.

[source,powershell]
----
Disable-MalwareFilterRule -Identity "Marketing Department"
----

This example enables same rule.

[source,powershell]
----
Enable-MalwareFilterRule -Identity "Marketing Department"
----

For detailed syntax and parameter information, see
link:/powershell/module/exchange/enable-malwarefilterrule[Enable-MalwareFilterRule]
and
link:/powershell/module/exchange/disable-malwarefilterrule[Disable-MalwareFilterRule].

==== Use PowerShell to set the priority of malware filter rules

The highest priority value you can set on a rule is 0. The lowest value
you can set depends on the number of rules. For example, if you have
five rules, you can use the priority values 0 through 4. Changing the
priority of an existing rule can have a cascading effect on other rules.
For example, if you have five custom rules (priorities 0 through 4), and
you change the priority of a rule to 2, the existing rule with priority
2 is changed to priority 3, and the rule with priority 3 is changed to
priority 4.

To set the priority of a malware filter rule in PowerShell, use the
following syntax:

[source,powershell]
----
Set-MalwareFilterRule -Identity "<RuleName>" -Priority <Number>
----

This example sets the priority of the rule named Marketing Department to
2. All existing rules that have a priority less than or equal to 2 are
decreased by 1 (their priority numbers are increased by 1).

[source,powershell]
----
Set-MalwareFilterRule -Identity "Marketing Department" -Priority 2
----

*Notes*:

* To set the priority of a new rule when you create it, use the
_Priority_ parameter on the *New-MalwareFilterRule* cmdlet instead.
* The default malware filter policy doesn’t have a corresponding malware
filter rule, and it always has the unmodifiable priority value *Lowest*.

==== Use PowerShell to remove malware filter policies

When you use PowerShell to remove a malware filter policy, the
corresponding malware filter rule isn’t removed.

To remove a malware filter policy in PowerShell, use this syntax:

[source,powershell]
----
Remove-MalwareFilterPolicy -Identity "<PolicyName>"
----

This example removes the malware filter policy named Marketing
Department.

[source,powershell]
----
Remove-MalwareFilterPolicy -Identity "Marketing Department"
----

For detailed syntax and parameter information, see
link:/powershell/module/exchange/remove-malwarefilterpolicy[Remove-MalwareFilterPolicy].

==== Use PowerShell to remove malware filter rules

When you use PowerShell to remove a malware filter rule, the
corresponding malware filter policy isn’t removed.

To remove a malware filter rule in PowerShell, use this syntax:

[source,powershell]
----
Remove-MalwareFilterRule -Identity "<PolicyName>"
----

This example removes the malware filter rule named Marketing Department.

[source,powershell]
----
Remove-MalwareFilterRule -Identity "Marketing Department"
----

For detailed syntax and parameter information, see
link:/powershell/module/exchange/remove-malwarefilterrule[Remove-MalwareFilterRule].

=== How do you know these procedures worked?

==== Use the EICAR.TXT file to verify your anti-malware policy settings

____
[!IMPORTANT] The EICAR.TXT file is not a virus. The European Institute
for Computer Antivirus Research (EICAR) developed this file to safely
test anti-virus installations and settings.
____

[arabic]
. Open Notepad and paste the following text into an empty file:
+
[source,text]
----
X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
----
+
Be sure that these are the only text characters in the file. The file
size should be 68 bytes.
. Save the file as EICAR.TXT
+
In your desktop anti-virus program, be sure to exclude the EICAR.TXT
from scanning (otherwise, the file will be quarantined).
. Send an email message that contains the EICAR.TXT file as an
attachment, using an email client that won’t automatically block the
file, and using an email service that doesn’t automatically block
outbound spam. Use your anti-malware policy settings to determine the
following scenarios to test:
* Email from an internal mailbox to an internal recipient.
* Email from an internal mailbox to an external recipient.
* Email from an external mailbox to an internal recipient.
. Verify that the message was quarantined, and verify the admin
notification results based on your anti-malware policy settings. For
example, the admin email address that you specified is notified for
internal or external message senders, with the default or customized
notification messages.
. Delete the EICAR.TXT file after your testing is complete (so other
users aren’t unnecessarily alarmed by it).
