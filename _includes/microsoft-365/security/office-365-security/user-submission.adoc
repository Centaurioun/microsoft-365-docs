= 
chrisda

== User reported message settings

{empty}[!INCLUDE link:../includes/mdo-trial-banner.md[MDO Trial banner]]

*Applies to* - link:exchange-online-protection-overview.md[Exchange
Online Protection] - link:defender-for-office-365.md[Microsoft Defender
for Office 365 plan 1 and plan 2] -
link:../defender/microsoft-365-defender.md[Microsoft 365 Defender]

In Microsoft 365 organizations with Exchange Online mailboxes, you can
direct mail to a custom mailbox (also known as the _user submissions
mailbox_) when users report malicious or not malicious messages. When
users report email messages using the supported reporting options,
admins can configure the user reported message settings in their
organization to send reported messages to the user submissions mailbox.
You can configure the user submissions mailbox to intercept
user-reported messages (send to the user submissions mailbox only) or
receive copies of user-reported messages as users report messages to
Microsoft. These settings were formerly known as the _User submissions
policy_.

User reported message settings and the user submissions mailbox work
with the following message reporting options:

* link:enable-the-report-message-add-in.md[The Report Message add-in]
* link:enable-the-report-phish-add-in.md[The Report Phishing add-in]
* link:#third-party-reporting-tools-options[Third-party reporting tools]

Delivering user reported messages to a user submissions mailbox instead
of directly to Microsoft allows admins to selectively and manually
report messages to Microsoft on the *Submissions* page at
https://security.microsoft.com/reportsubmission. For more information,
see link:admin-submission.md[Admin submission].

____
[!NOTE] If reporting has been
link:report-junk-email-and-phishing-scams-in-outlook-on-the-web-eop.md#disable-or-enable-junk-email-reporting-in-outlook-on-the-web[disabled
in Outlook on the web], enabling user-reported messages here will
override that setting and allow users to report messages in Outlook on
the web again.
____

=== Configuration requirements for the user submissions mailbox

Before you get started, you need to configure Exchange Online Protection
and Defender for Office 365 so user reported messages are delivered to
the user submissions mailbox without being filtered as described in the
following steps:

* Identify the user submissions mailbox as a SecOps mailbox. For
instructions, see
link:configure-advanced-delivery.md#use-the-microsoft-365-defender-portal-to-configure-secops-mailboxes-in-the-advanced-delivery-policy[Use
the Microsoft 365 Defender portal to configure SecOps mailboxes in the
advanced delivery policy].
* Create a custom anti-malware policy for the user submissions mailbox
with the following settings:
** Turn off Zero-hour auto purge (ZAP) for malware (*Protection
settings* section > *Enable zero-hour auto purge for malware* is not
selected or `-ZapEnabled $false` in PowerShell).
** Turn off common attachments filtering (*Protection settings* section
> *Enable the common attachments filter* is not selected or
`EnableFileFilter $false` in PowerShell).
+
For instructions, see
link:configure-anti-malware-policies.md#use-the-microsoft-365-defender-portal-to-create-anti-malware-policies[Create
an anti-malware policy].
* Verify the user submissions mailbox is not included in the *Standard*
or *Strict* preset security policies. For instructions, see
link:preset-security-policies.md[Preset security policies].
* *Defender for Office 365*: Configure the following additional
settings:
** Exclude the user submissions mailbox from the *Built-in protection*
preset security policy. For instructions, see
link:preset-security-policies.md[Preset security policies].
** Create a Safe Attachments policy for the user submissions mailbox
where Safe Attachments scanning, including Dynamic Delivery, is turned
off (*Settings* > *Safe Attachments unknown malware response* section >
*Off* or `-Enable $false` in PowerShell). For instructions, see
link:set-up-safe-attachments-policies.md[Set up Safe Attachments
policies in Microsoft Defender for Office 365].
** Create a Safe Links policy for the user submissions mailbox where
Safe Links scanning in email is turned off (*URL & click protection
settings* > *On: Safe Links checks a list of known, malicious links when
users click links in email* is not selected or
`EnableSafeLinksForEmail $false` in PowerShell). For instructions, see
link:set-up-safe-links-policies.md[Set up Safe Links policies in
Microsoft Defender for Office 365].

After you’ve verified that the mailbox meets these requirements, use the
rest of the instructions in this article to identify the user
submissions mailbox and other user reported message settings.

=== What do you need to know before you begin?

* You open the Microsoft 365 Defender portal at
https://security.microsoft.com. To go directly to the *User submissions*
page, use https://security.microsoft.com/userSubmissionsReportMessage.
* To connect to Exchange Online PowerShell, see
link:/powershell/exchange/connect-to-exchange-online-powershell[Connect
to Exchange Online PowerShell].
* To modify the configuration for User submissions, you need to be a
member of one of the following role groups:
** *Organization Management* or *Security Administrator* in the
link:permissions-microsoft-365-security-center.md[Permissions in the
Microsoft 365 Defender portal].
* You need access to Exchange Online PowerShell. If the account that
you’re trying to use doesn’t have access to Exchange Online PowerShell,
you’ll receive an error that looks like this when specifying the
submissions mailbox:
+
____
Specify an email address in your domain
____
+
For more information about enabling or disabling access to Exchange
Online PowerShell, see the following topics:
** link:/powershell/exchange/disable-access-to-exchange-online-powershell[Enable
or disable access to Exchange Online PowerShell]
** link:/exchange/clients-and-mobile-in-exchange-online/client-access-rules/client-access-rules[Client
Access Rules in Exchange Online]

=== Use the Microsoft 365 Defender portal to configure the user submissions mailbox for email

[arabic]
. In the Microsoft 365 Defender portal at
https://security.microsoft.com, go to *Policies & rules* > *Threat
policies* > *User reported message settings* in the *Others* section. To
go directly to the *User submissions* page, use
https://security.microsoft.com/userSubmissionsReportMessage.
. On the *User submissions* page, what you see is largely determined by
the *Microsoft Outlook Report Message button* toggle:
* *On* image:../../media/scc-toggle-on.png[Toggle on.]: You use the
Microsoft integrated reporting experience, which includes the Report
Message add-in, the Report Phishing add-in or the built-in reporting in
Outlook on the web.
+
This setting also allows users to report false positive messages from
the quarantine portal.
* *Off* image:../../media/scc-toggle-off.png[Toggle off.]: You use
third-party message reporting tools instead of the Microsoft integrated
reporting experience.

The related configuration options are described in the following
sections.

==== Microsoft integrated reporting experience options

When *Microsoft Outlook Report Message button* is *On*
image:../../media/scc-toggle-on.png[Toggle on.], the following settings
are available on the *User submissions* page:

* *Send the reported messages to* section: Select one of the following
options:
** *Microsoft*: The user reports go directly to Microsoft for analysis.
Only the metadata such as sender, recipient, reported by, and the
message details from the user reports are provided to the tenant admin
via the Microsoft 365 Defender portal.
** *Microsoft and my organization’s mailbox*: In the box that appears,
enter the email address of an existing Exchange Online mailbox to use as
the user submissions mailbox. Distribution groups are not allowed. User
submissions go to Microsoft for analysis and to the user submissions
mailbox for an admin or security operations team to analyze.
** *My organization’s mailbox*: In the box that appears, enter the email
address of an existing Exchange Online mailbox. Distribution groups are
not allowed. User submissions go only to the user submissions mailbox
for an admin or the security operations team to analyze. Messages don’t
go to Microsoft for analysis unless an admin manually submits the
messages.
+
____
[!IMPORTANT] In U.S. Government organizations (GCC, GCC High, and DoD)
organizations, the only available selection in the *Send the reported
messages to* section is *My organization’s mailbox*. The other two
options are grayed out.

If you used
link:/exchange/clients-and-mobile-in-exchange-online/outlook-on-the-web/configure-outlook-web-app-mailbox-policy-properties[Outlook
on the web mailbox policies] to disable junk email reporting in Outlook
on the web, but you select *Microsoft* or *Microsoft and my
organization’s mailbox*, users will be able to report messages to
Microsoft in Outlook on the web using the Report Message add-in or the
Report Phishing add-in.

If you select *My organization’s mailbox*, reported messages appear on
the *User reported messages* tab on the *Submissions* page at
https://security.microsoft.com/reportsubmission. But the *Result* value
of these messages will always be empty, because the messages were not
rescanned.

If you use link:attack-simulation-training-get-started.md[Attack
simulation training] or a third-party product to do phishing
simulations, you must configure the user submissions mailbox as a SecOps
mailbox as previously described in the
link:#configuration-requirements-for-the-user-submissions-mailbox[Configuration
requirements for the user submissions mailbox] section earlier in this
article. If you don’t, a user reporting a message might trigger a
training assignment in the phishing simulation product.
____
+
Regardless of your selection, the following settings are also available
in the *Send the reported messages to* section:
** *Let users choose if they want to report*: This setting controls the
options that are available in the *Select reporting options that are
available to users* section:
*** *Let users choose if they want to report* selected: You can select
some, all or none of the settings in the *Select reporting options that
are available to users* section.
*** *Let users choose if they want to report* not selected: You can
select only one setting in the *Select reporting options that are
available to users* section.
*** *Select reporting options that are available to users* section:
**** *Ask me before sending the message*
**** *Always report the message*
**** *Never report the message*
* *User reporting experience* section: The following settings are
available:
+
As shown on the page, if you select an option that sends the reported
messages to Microsoft, the following text is also added to the
notification:
+
____
Your email will be submitted as-is to Microsoft for analysis. Some
emails might contain personal or sensitive information.
____
** *Before reporting* tab: In the *Title* and *Message body* boxes,
enter the descriptive text that users see before they report a message
using the Report Message add-in or the Report Phishing add-in. You can
use the variable `%type%` to include the submission type (junk, not
junk, phishing, etc.).
** *After reporting* tab: In the *Title* and *Confirmation message*
boxes, enter the descriptive text that users see after they report a
message using the Report Message add-in or the Report Phishing add-in.
You can use the variable `%type%` to include the submission type.
** *Only display when user reports phishing*: Select this option to
display the *Before reporting* and *After reporting* notifications only
when users report messages as phishing. Otherwise, the notifications are
shown for all reported messages.
* *Email notifications for admin review results* section: The following
settings are available:
** *Specify Office 365 email address to use as sender*: Select this
setting and enter the email address in the box that appears.
** *Customize notifications*: Click this link to customize the email
notification that’s sent after an admin reviews and marks a reported
message.
+
On the *Customize confirmation message* flyout that appears, configure
the following settings:
*** *Phishing*, *Junk* and *No threats found* tabs: In the *Review
result text* on some, none, or all of the tabs, enter the custom text to
use.
*** *Footer* tab: The following options are available:
**** *Footer text*: Enter the custom message footer text to use.
**** *Display company logo*: Before you select this option, you need to
follow the instructions in
link:../../admin/setup/customize-your-organization-theme.md[Customize
the Microsoft 365 theme for your organization] to upload your custom
logo.
+
When you’re finished on the *Customize confirmation message* flyout,
click *Confirm*.
* *Customize your organization’s experience when reporting potential
threats in quarantine* section:
+
*Quarantine report message button*: Verify this setting is *On*
image:../../media/scc-toggle-on.png[Toggle on.] to let users report
messages from quarantine. Otherwise, turn this setting *Off*
image:../../media/scc-toggle-off.png[Toggle off.].

When you’re finished on the *User submissions* page, click *Save*. To
restore the settings to their immediately previous values, click
*Restore*.

==== Third-party reporting tools options

You can turn off the Microsoft integrated reporting experience to use
third-party message reporting tools to send reported messages to the
user submissions mailbox.

The only requirement is that the original messages are included as
uncompressed .EML or .MSG attachments in messages that are sent to user
submissions mailbox. In other words, don’t just forward the original
messages to the user submissions mailbox.

____
[!NOTE] If multiple email attachments exist in the message, then the
submission will be discarded. We only support message with one email
attachment.
____

The message formatting requirements are described in the next section.
The formatting is optional, but reported messages don’t follow the
prescribed format, the reported messages are always identified as
phishing.

When *Microsoft Outlook Report Message button* is *Off*
image:../../media/scc-toggle-off.png[Toggle off.] the following settings
are available on the *User submissions* page:

* *Microsoft and my organization’s mailbox*: In the box that appears,
enter the email address of an existing Exchange Online mailbox to use as
the user submissions mailbox. Distribution groups are not allowed.
* *Customize your organization’s experience when reporting potential
threats in quarantine* section:
+
*Quarantine report message button*: Verify this setting is *On*
image:../../media/scc-toggle-on.png[Toggle on.] to let users report
messages from quarantine. Otherwise, turn this setting *Off*
image:../../media/scc-toggle-off.png[Toggle off.].

When you’re finished on the *User submissions* page, click *Save*. To
restore the settings to their immediately previous values, click
*Restore*.

===== Message submission format

To correctly identify the original attached messages, messages sent to
the custom mailbox require specific formatting. If the messages don’t
use this format, the original attached messages are always identified as
phishing.

To specify the reason why the original attached messages were reported,
messages sent to the user submissions mailbox must meet the following
criteria:

* The original message attachment is unmodified.
* The reported message should contain the following required headers:
** {blank}
[arabic]
. X-Microsoft-Antispam-Message-Info
** {blank}
[arabic, start=2]
. Message-Id
** {blank}
[arabic, start=3]
. X-Ms-Exchange-Organization-Network-Message-Id
** {blank}
[arabic, start=4]
. X-Ms-Exchange-Crosstenant-Id

____
[!NOTE] TenantId in `X-Ms-Exchange-Crosstenant-Id` should be the same as
the tenant.

`X-Microsoft-Antispam-Message-Info` should be a valid xmi.
____

* The Subject line (Envelope Title) of messages sent to the user
submissions mailbox must start with one of the following prefix values:
** `1|` or `Junk:`.
** `2|` or `Not junk:`.
** `3|` or `Phishing:`.
+
For example:
** `3|This text in the Subject line is ignored by the system`
** `Not Junk:This text in the Subject line is also ignored by the system`
+
Messages that don’t follow this format will not display properly on the
*Submissions* page at https://security.microsoft.com/reportsubmission.
