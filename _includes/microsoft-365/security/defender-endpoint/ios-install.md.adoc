= App-based deployment for Microsoft Defender for Endpoint on iOS
:audience: ITPro
:author: mjcaparas
:description: Describes how to deploy Microsoft Defender for Endpoint on iOS using an app
:keywords: microsoft, defender, Microsoft Defender for Endpoint, ios, app, installation, deploy, uninstallation, intune
:manager: dansimp
:ms.author: macapara
:ms.collection: ["m365-security-compliance"]
:ms.localizationpriority: medium
:ms.mktglfcycl: deploy
:ms.pagetype: security
:ms.reviewer:
:ms.service: microsoft-365-security
:ms.sitesec: library
:ms.subservice: mde
:ms.topic: conceptual
:search.appverid: met150

== Deploy Microsoft Defender for Endpoint on iOS

[!INCLUDE xref:../../includes/microsoft-defender.adoc[Microsoft 365 Defender rebranding]]

*Applies to:*

* https://go.microsoft.com/fwlink/p/?linkid=2154037[Microsoft Defender for Endpoint Plan 1]
* https://go.microsoft.com/fwlink/p/?linkid=2154037[Microsoft Defender for Endpoint Plan 2]
* https://go.microsoft.com/fwlink/?linkid=2118804[Microsoft 365 Defender]

____
Want to experience Defender for Endpoint?
https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-investigateip-abovefoldlink[Sign up for a free trial.]
____

This topic describes deploying Defender for Endpoint on iOS on Intune Company Portal enrolled devices.
For more information about Intune device enrollment, see link:/mem/intune/enrollment/ios-enroll[Enroll iOS/iPadOS devices in Intune].

=== Before you begin

* Ensure you have access to https://go.microsoft.com/fwlink/?linkid=2109431[Microsoft Endpoint manager admin center].
* Ensure iOS enrollment is done for your users.
Users need to have a Defender for Endpoint license assigned in order to use Defender for Endpoint on iOS.
Refer to link:/azure/active-directory/users-groups-roles/licensing-groups-assign[Assign licenses to users] for instructions on how to assign licenses.

____
[!NOTE] Microsoft Defender for Endpoint on iOS is available in the https://aka.ms/mdatpiosappstore[Apple App Store].
____

=== Deployment steps

Deploy Defender for Endpoint on iOS via Intune Company Portal.

==== Add iOS store app

. In https://go.microsoft.com/fwlink/?linkid=2109431[Microsoft Endpoint manager admin center], go to *Apps* > *iOS/iPadOS* > *Add* > *iOS store app* and click *Select*.
+
____
:::image type="content" source="images/ios-deploy-1.png" alt-text="The Add applications tab in the Microsoft Endpoint Manager Admin Center" lightbox="images/ios-deploy-1.png":::
____

. On the *Add app* page, click on *Search the App Store* and type *Microsoft Defender* in the search bar.
In the search results section, click on _Microsoft Defender_ and click *Select*.
. Select *iOS 11.0* as the Minimum operating system.
Review the rest of information about the app and click *Next*.
. In the *Assignments* section, go to the *Required* section and select *Add group*.
You can then choose the user group(s) that you would like to target Defender for Endpoint on iOS app.
Click *Select* and then *Next*.
+
____
[!NOTE] The selected user group should consist of Intune enrolled users.
____
+
:::image type="content" source="images/ios-deploy-2.png" alt-text="The Add group tab in the Microsoft Endpoint Manager Admin Center" lightbox="images/ios-deploy-2.png":::

. In the _Review + Create_ section, verify that all the information entered is correct and then select *Create*.
In a few moments, the Defender for Endpoint app should be created successfully, and a notification should show up at the top-right corner of the page.
. In the app information page that is displayed, in the *Monitor* section, select *Device install status* to verify that the device installation has completed successfully.
+
____
:::image type="content" source="images/ios-deploy-3.png" alt-text="The Device install status page" lightbox="images/ios-deploy-3.png":::
____

=== Complete deployment for supervised devices

The Microsoft Defender for Endpoint on iOS app has specialized ability on supervised iOS/iPadOS devices, given the increased management capabilities provided by the platform on these types of devices.
It can also provide Web Protection *without setting up a local VPN on the device*.
This gives end-users a seamless experience while still being protected from phishing and other web-based attacks.

Admins can use the following steps to configure supervised devices.

==== Configure Supervised Mode via Intune

Configure the supervised mode for Defender for Endpoint app through an App configuration policy and Device configuration profile.

===== App configuration policy

____
[!NOTE] This app configuration policy for supervised devices is applicable only to managed devices and should be targeted for ALL managed iOS devices as a best practice.
____

. Sign in to the https://go.microsoft.com/fwlink/?linkid=2109431[Microsoft Endpoint Manager admin center] and go to *Apps* > *App configuration policies* > *Add*.
Select *Managed devices*.
+
____
[!div class="mx-imgBorder"] image:images/ios-deploy-4.png[Image of Microsoft Endpoint Manager Admin Center4.]
____

. In the _Create app configuration policy_ page, provide the following information:
 ** Policy Name
 ** Platform: Select iOS/iPadOS
 ** Targeted app: Select *Microsoft Defender for Endpoint* from the list

+
____
[!div class="mx-imgBorder"] image:images/ios-deploy-5.png[Image of Microsoft Endpoint Manager Admin Center5.]
____
. In the next screen, select *Use configuration designer* as the format.
Specify the following property:
 ** Configuration Key: `issupervised`
 ** Value type: String
 ** Configuration Value: `issupervised`

+
____
[!div class="mx-imgBorder"] image:images/ios-deploy-6.png[Image of Microsoft Endpoint Manager Admin Center6.]
____
. Select *Next* to open the *Scope tags* page.
Scope tags are optional.
Select *Next* to continue.
. On the *Assignments* page, select the groups that will receive this profile.
For this scenario, it is best practice to target *All Devices*.
For more information on assigning profiles, see link:/mem/intune/configuration/device-profile-assign[Assign user and device profiles].
+
When deploying to user groups, a user must sign in to a device before the policy applies.
+
Click *Next*.

. On the *Review + create* page, when you're done, choose *Create*.
The new profile is displayed in the list of configuration profiles.

===== Device configuration profile

____
[!NOTE] For devices that run iOS/iPadOS (in Supervised Mode), there is  custom *.mobileconfig* profile, called the *ControlFilter* profile available.
This profile enables Web Protection *without setting up the local loopback VPN on the device*.
This gives end-users a seamless experience while still being protected from phishing and other web-based attacks.
____

Deploy a custom profile on supervised iOS devices.
This is for enhanced Anti-phishing capabilities.
Follow the steps below:

. Download the config profile from https://aka.ms/mdeiosprofilesupervised
. Navigate to *Devices* > *iOS/iPadOS* > *Configuration profiles* > *Create Profile*
. Select *Profile Type* > *Templates* and *Template name* > *Custom*
+
____
[!div class="mx-imgBorder"] image:images/ios-deploy-7.png[Image of Microsoft Endpoint Manager Admin Center7.]
____

. Provide a name of the profile.
When prompted to import a Configuration profile file, select the one downloaded from the previous step.
. In the *Assignment* section, select the device group to which you want to apply this profile.
As a best practice, this should be applied to all managed iOS devices.
Select *Next*.
+
____
[!NOTE] Device Group creation is supported in both Defender for Endpoint Plan 1 and Plan 2
____

. On the *Review + create* page, when you're done, choose *Create*.
The new profile is displayed in the list of configuration profiles.

=== Auto-Onboarding of VPN profile (Simplified Onboarding)

For unsupervised devices, a VPN is used in order to provide the Web Protection feature.
This is not a regular VPN and is a local/self-looping VPN that does not take traffic outside the device.

____
[!NOTE] For supervised devices, a VPN is not needed for Web Protection capability and requires admins to set up a configuration profile on supervised devices.
To configure for supervised devices, follow the steps in the <<complete-deployment-for-supervised-devices,Complete deployment for supervised devices>> section.
____

Admins can configure auto-setup of VPN profile.
This will automatically set up the Defender for Endpoint VPN profile without having the user to do so while onboarding.

This step simplifies the onboarding process by setting up the VPN profile.
For a zero-touch or silent onboarding experience, see the next section: <<zero-touch-onboarding-of-microsoft-defender-for-endpoint,Zero-touch onboard>>.

. In https://go.microsoft.com/fwlink/?linkid=2109431[Microsoft Endpoint manager admin center], go to *Devices* > *Configuration Profiles* > *Create Profile*.
. Choose *Platform* as *iOS/iPadOS* and *Profile type* as *VPN*.
Click *Create*.
. Type a name for the profile and click *Next*.
. Select *Custom VPN* for Connection Type and in the *Base VPN* section, enter the following:
 ** Connection Name = Microsoft Defender for Endpoint
 ** VPN server address = 127.0.0.1
 ** Auth method = "Username and password"
 ** Split Tunneling = Disable
 ** VPN identifier = com.microsoft.scmx
 ** In the key-value pairs, enter the key *AutoOnboard* and set the value to *True*.
 ** Type of Automatic VPN = On-demand VPN
 ** Select *Add* for *On Demand Rules* and select *I want to do the following = Connect VPN*, *I want to restrict to = All domains*.

+
:::image type="content" source="images/ios-deploy-8.png" alt-text="The VPN profile Configuration settings tab" lightbox="images/ios-deploy-8.png":::
 ** To mandate that VPN cannot be disabled in users device, Admins can select *Yes* from *Block users from disabling automatic VPN*.
By default, it's not configured and users can disable VPN only in the Settings.
 ** To allow Users to Change the VPN toggle from within the app, add *EnableVPNToggleInApp = TRUE*, in the key-value pairs.
By default, users cannot change the toggle from within the app.
. Click Next and assign the profile to targeted users.
. In the _Review + Create_ section, verify that all the information entered is correct and then select *Create*.

=== Zero-touch onboarding of Microsoft Defender for Endpoint

____
[!NOTE] Zero-touch cannot be configured on iOS devices that are enrolled without user affinity (user-less devices or shared devices).
____

Admins can configure Microsoft Defender for Endpoint to deploy and activate silently.
In this flow, the administrator creates a deployment profile and the user is simply notified of the installation.
Defender for Endpoint is automatically installed without the need for the user to open the app.
Follow the steps below to set up zero-touch or silent deployment of Defender for Endpoint on enrolled iOS devices:

. In https://go.microsoft.com/fwlink/?linkid=2109431[Microsoft Endpoint manager admin center], go to *Devices* > *Configuration Profiles* > *Create Profile*.
. Choose *Platform* as *iOS/iPadOS* and *Profile type* as *VPN*.
Select *Create*.
. Type a name for the profile and select *Next*.
. Select *Custom VPN* for Connection Type and in the *Base VPN* section, enter the following:
 ** Connection Name = Microsoft Defender for Endpoint
 ** VPN server address = 127.0.0.1
 ** Auth method = "Username and password"
 ** Split Tunneling = Disable
 ** VPN identifier = com.microsoft.scmx
 ** In the key-value pairs, enter the key *SilentOnboard* and set the value to *True*.
 ** Type of Automatic VPN = On-demand VPN
 ** Select *Add* for *On Demand Rules* and select *I want to do the following = Connect VPN*, *I want to restrict to = All domains*.

+
:::image type="content" source="images/ios-deploy-9.png" alt-text="The VPN profile Configuration page" lightbox="images/ios-deploy-9.png":::
 ** To mandate that VPN can't be disabled in users device, Admins can select *Yes* from *Block users from disabling automatic VPN*.
By default, it's not configured and users can disable VPN only in the Settings.
 ** To allow Users to Change the VPN toggle from within the app, add *EnableVPNToggleInApp = TRUE*, in the key-value pairs.
By default, users can't change the toggle from within the app.
. Select *Next* and assign the profile to targeted users.
. In the _Review + Create_ section, verify that all the information entered is correct and then select *Create*.

Once the above configuration is done and synced with the device, the following actions take place on the targeted iOS device(s):     - Microsoft Defender for Endpoint will be deployed and silently onboarded and the device will be seen in the Defender for Endpoint portal.
- A provisional notification will be sent to the user device.
- Web Protection and other features will be activated.

____
[!NOTE] For supervised devices, although a VPN profile is not required, admins still can set up Zero-touch onboarding by configuring the Defender for Endpoint VPN profile through Intune.
The VPN profile will be deployed on the device but will only be present on the device as a pass-through profile and can be deleted after initial onboarding.
____

=== Complete onboarding and check status

. Once Defender for Endpoint on iOS has been installed on the device, you  will see the app icon.
+
:::image type="content" source="images/41627a709700c324849bf7e13510c516.png" alt-text="A smart phone Description automatically generated" lightbox="images/41627a709700c324849bf7e13510c516.png":::

. Tap the Defender for Endpoint app icon (MSDefender) and follow the on-screen instructions to complete the onboarding steps.
The details include end-user acceptance of iOS permissions required by Defender for Endpoint on iOS.
. Upon successful onboarding, the device will start showing up on the Devices list in the Microsoft 365 Defender portal.
+
____
:::image type="content" source="images/device-inventory-screen.png" alt-text="The Device inventory page" lightbox="images/device-inventory-screen.png":::
____

=== Configure Microsoft Defender for Endpoint for Supervised Mode

The Microsoft Defender for Endpoint on iOS app has specialized ability on supervised iOS/iPadOS devices, given the increased management capabilities provided by the platform on these types of devices.
To take advantage of these capabilities, the Defender for Endpoint app needs to know if a device is in Supervised Mode.

==== Configure Supervised Mode via Intune

Intune allows you to configure the Defender for iOS app through an App Configuration policy.

____
[!NOTE] This app configuration policy for supervised devices is applicable only to managed devices and should be targeted for all managed iOS devices as a best practice.
____

. Sign in to the https://go.microsoft.com/fwlink/?linkid=2109431[Microsoft Endpoint Manager admin center] and go to *Apps* > *App configuration policies* > *Add*.
Click on *Managed devices*.
+
____
:::image type="content" source="images/ios-deploy-4.png" alt-text="The Managed devices option" lightbox="images/ios-deploy-4.png":::
____

. In the _Create app configuration policy_ page, provide the following information:
 ** Policy Name
 ** Platform: Select iOS/iPadOS
 ** Targeted app: Select *Microsoft Defender for Endpoint* from the list

+
____
:::image type="content" source="images/ios-deploy-5.png" alt-text="The basic fields for the configuration policy for the application" lightbox="images/ios-deploy-5.png":::
____
. In the next screen, select *Use configuration designer* as the format.
Specify the following property:
 ** Configuration Key: `issupervised`
 ** Value type: String
 ** Configuration Value: `+{{issupervised}}+`

+
____
:::image type="content" source="images/ios-deploy-6.png" alt-text="The page from which to choose the format for the settings of the policy configuration" lightbox="images/ios-deploy-6.png":::
____
. Click *Next* to open the *Scope tags* page.
Scope tags are optional.
Click *Next* to continue.
. On the *Assignments* page, select the groups that will receive this profile.
For this scenario, it is best practice to target *All Devices*.
For more information on assigning profiles, see link:/mem/intune/configuration/device-profile-assign[Assign user and device profiles].
+
When deploying to user groups, a user must sign in to a device before the policy applies.
+
Select *Next*.

. On the *Review + create* page, when you're done, choose *Create*.
The new profile is displayed in the list of configuration profiles.

=== Next Steps

* xref:ios-install-unmanaged.adoc[Configure app protection policy to include Defender for Endpoint risk signals (MAM)]
* xref:ios-configure-features.adoc[Configure Defender for Endpoint on iOS features]
