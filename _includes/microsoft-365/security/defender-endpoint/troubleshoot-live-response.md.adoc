= Troubleshoot Microsoft Defender for Endpoint live response issues
:audience: ITPro
:author: mjcaparas
:description: Troubleshoot issues that might arise when using live response in Microsoft Defender for Endpoint
:keywords: troubleshoot live response, live, response, locked, file
:manager: dansimp
:ms.author: macapara
:ms.collection: M365-security-compliance
:ms.localizationpriority: medium
:ms.mktglfcycl: deploy
:ms.pagetype: security
:ms.service: microsoft-365-security
:ms.sitesec: library
:ms.subservice: mde
:ms.topic: troubleshooting
:search.appverid: met150

== Troubleshoot Microsoft Defender for Endpoint live response issues

[!INCLUDE xref:../../includes/microsoft-defender.adoc[Microsoft 365 Defender rebranding]]

*Applies to:*

* https://go.microsoft.com/fwlink/?linkid=2154037[Microsoft Defender for Endpoint Plan 1]
* https://go.microsoft.com/fwlink/?linkid=2154037[Microsoft Defender for Endpoint Plan 2]
* https://go.microsoft.com/fwlink/?linkid=2118804[Microsoft 365 Defender]

____
Want to experience Defender for Endpoint?
https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-pullalerts-abovefoldlink[Sign up for a free trial.]
____

This page provides detailed steps to troubleshoot live response issues.

=== File cannot be accessed during live response sessions

If while trying to take an action during a live response session, you encounter an error message stating that the file can't be accessed, you'll need to use the steps below to address the issue.

. Copy the following script code snippet and save it as a PS1 file:
+
[,powershell]
----
 $copied_file_path=$args[0]
 $action=Copy-Item $copied_file_path -Destination $env:TEMP -PassThru -ErrorAction silentlyContinue

 if ($action){
      Write-Host "You copied the file specified in $copied_file_path to $env:TEMP Succesfully"
 }

 else{
     Write-Output "Error occoured while trying to copy a file, details:"
     Write-Output  $error[0].exception.message

 }
----

. Add the script to the live response library.
. Run the script with one parameter: the file path of the file to be copied.
. Navigate to your TEMP folder.
. Run the action you wanted to take on the copied file.

=== Slow live response sessions or delays during initial connections

Live response leverages Defender for Endpoint sensor registration with WNS service in Windows.
If you are having connectivity issues with live response, confirm the following details:

. WpnService (Windows Push Notifications System Service) is not disabled.
. WpnService connectivity with WNS cloud is not disabled via group policy or MDM setting.
link:/windows/client-management/mdm/policy-csp-notifications['Turn off notifications network usage'] should not be set to '1'.

Refer to the articles below to fully understand the WpnService service behavior and requirements:

* link:/windows/uwp/design/shell/tiles-and-notifications/windows-push-notification-services--wns--overview[Windows Push Notification Services (WNS) overview]
* link:/windows/uwp/design/shell/tiles-and-notifications/firewall-allowlist-config[Enterprise Firewall and Proxy Configurations to Support WNS Traffic]
* https://www.microsoft.com/download/details.aspx?id=44535[Microsoft Push Notifications Service (MPNS) Public IP ranges]
