= Import, export, and deploy exploit protection configurations
:audience: ITPro
:author: dansimp
:description: Use Group Policy to deploy mitigations configuration.
:keywords: Exploit protection, mitigations, import, export, configure, convert, conversion, deploy, install
:manager: dansimp
:ms.author: dansimp
:ms.collection: M365-security-compliance
:ms.date:
:ms.localizationpriority: medium
:ms.mktglfcycl: manage
:ms.pagetype: security
:ms.reviewer:
:ms.service: microsoft-365-security
:ms.sitesec: library
:ms.subservice: mde
:ms.topic: article
:search.appverid: met150

== Import, export, and deploy exploit protection configurations

[!INCLUDE xref:../../includes/microsoft-defender.adoc[Microsoft 365 Defender rebranding]]

*Applies to:*

* https://go.microsoft.com/fwlink/p/?linkid=2154037[Microsoft Defender for Endpoint Plan 1]
* https://go.microsoft.com/fwlink/p/?linkid=2154037[Microsoft Defender for Endpoint Plan 2]
* https://go.microsoft.com/fwlink/?linkid=2118804[Microsoft 365 Defender]

____
Want to experience Defender for Endpoint?
https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-exposedapis-abovefoldlink[Sign up for a free trial.]
____

Exploit protection helps protect devices from malware that use exploits to spread and infect.
It consists of a number of mitigations that can be applied at either the operating system level, or at the individual app level.

You use the Windows Security app or PowerShell to create a set of mitigations (known as a configuration).
You can then export this configuration as an XML file and share it with multiple devices on your network.
Then, they all have the same set of mitigation settings.

=== Create and export a configuration file

Before you export a configuration file, you need to ensure you have the correct settings.
First, configure exploit protection on a single, dedicated device.
See xref:customize-exploit-protection.adoc[Customize exploit protection] for more information about configuring mitigations.

When you've configured exploit protection to your desired state (including both system-level and app-level mitigations), you can export the file using either the Windows Security app or PowerShell.

==== Use the Windows Security app to export a configuration file

. Open the Windows Security app by selecting the shield icon in the task bar.
Or, search the start menu for *Windows Security*.
. Select the *App & browser control* tile (or the app icon on the left menu bar) and then select *Exploit protection settings*:
+
:::image type="content" source="../../media/wdsc-exp-prot.png" alt-text="The Exploit protection settings option in the Windows Security app" lightbox="../../media/wdsc-exp-prot.png":::

. At the bottom of the *Exploit protection* section, select *Export settings*.
Choose the location and name of the XML file where you want the configuration to be saved.
+
____
[!IMPORTANT] If you want to use Default configuration, use the settings "On by default" instead of "Use Default (On)" to get the settings exported correctly on the XML file.
____
+
:::image type="content" source="../../media/wdsc-exp-prot-export.png" alt-text="The Export Settings option" lightbox="../../media/wdsc-exp-prot-export.png":::
+
____
[!NOTE] When you export the settings, all settings for both app-level and system-level mitigations are saved.
This means you don't need to export a file from both the *System settings* and *Program settings* sections (either section will export all settings).
____

==== Use PowerShell to export a configuration file

. Type *powershell* in the Start menu, right-click *Windows PowerShell* and select *Run as administrator*.
. Enter the following cmdlet:
+
[,powershell]
----
 Get-ProcessMitigation -RegistryConfigFilePath filename.xml
----
+
Change `filename` to any name or location of your choosing.
+
Example command:
+
[,powershell]
----
 Get-ProcessMitigation -RegistryConfigFilePath C:\ExploitConfigfile.xml
----

____
[!IMPORTANT] When you deploy the configuration using Group Policy, all devices that will use the configuration must be able to access the configuration file.
Ensure you place the file in a shared location.
____

=== Import a configuration file

You can import an exploit protection configuration file that you've previously created.
You can only use PowerShell to import the configuration file.

After importing, the settings will be instantly applied and can be reviewed in the Windows Security app.

==== Use PowerShell to import a configuration file

. Type *powershell* in the Start menu, right-click *Windows PowerShell* and select *Run as administrator*.
. Enter the following cmdlet:
+
[,powershell]
----
 Set-ProcessMitigation -PolicyFilePath filename.xml
----
+
Change `filename` to the location and name of the exploit protection XML file.
+
Example command:
+
[,powershell]
----
 Set-ProcessMitigation -PolicyFilePath C:\ExploitConfigfile.xml
----

____
[!IMPORTANT] Ensure you import a configuration file that is created specifically for exploit protection.
____

=== Manage or deploy a configuration

You can use Group Policy to deploy the configuration you've created to multiple devices in your network.

____
[!IMPORTANT] When you deploy the configuration using Group Policy, all devices that will use the configuration must be able to access the configuration XML file.
Ensure you place the file in a shared location.
____

==== Use Group Policy to distribute the configuration

. On your Group Policy management device, open the link:/previous-versions/windows/desktop/gpmc/group-policy-management-console-portal[Group Policy Management Console], right-click the Group Policy Object you want to configure and *Edit*.
. In the *Group Policy Management Editor*, go to *Computer configuration* and select *Administrative templates*.
. Expand the tree to *Windows components* > *Windows Defender Exploit Guard* > *Exploit protection*.
+
:::image type="content" source="../../media/exp-prot-gp.png" alt-text="The group policy setting for exploit protection" lightbox="../../media/exp-prot-gp.png":::

. Double-click *Use a common set of Exploit protection settings* and set the option to *Enabled*.
. In the *Options:* section, enter the location and file name of the Exploit protection configuration file that you want to use, such as in the following examples:
 ** `C:\MitigationSettings\Config.XML`
 ** `\\Server\Share\Config.xml`
 ** `+https://localhost:8080/Config.xml+`
 ** `C:\ExploitConfigfile.xml`
. Select *OK* and link:/windows/win32/srvnodes/group-policy[Deploy the updated GPO as you normally do].

=== See also

* xref:exploit-protection.adoc[Protect devices from exploits]
* xref:evaluate-exploit-protection.adoc[Evaluate exploit protection]
* xref:enable-exploit-protection.adoc[Enable exploit protection]
* xref:customize-exploit-protection.adoc[Configure and audit exploit protection mitigations]
