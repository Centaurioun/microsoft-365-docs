= 
mjcaparas
:keywords: apis, graph api, supported apis, submit, ti, indicator,
update

== Submit or Update Indicator API

{empty}[!INCLUDE link:../../includes/microsoft-defender.md[Microsoft 365
Defender rebranding]]

*Applies to:* -
https://go.microsoft.com/fwlink/p/?linkid=2154037[Microsoft Defender for
Endpoint Plan 1] -
https://go.microsoft.com/fwlink/p/?linkid=2154037[Microsoft Defender for
Endpoint Plan 2] -
https://go.microsoft.com/fwlink/?linkid=2118804[Microsoft 365 Defender]

____
Want to experience Defender for Endpoint?
https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-exposedapis-abovefoldlink[Sign
up for a free trial.]
____

{empty}[!includelink:../../includes/microsoft-defender-api-usgov.md[Microsoft
Defender for Endpoint API URIs for US Government]]

{empty}[!includelink:../../includes/improve-request-performance.md[Improve
request performance]]

=== API description

Submits or Updates new link:ti-indicator.md[Indicator] entity.

CIDR notation for IPs is not supported.

=== Limitations

[arabic]
. Rate limitations for this API are 100 calls per minute and 1500 calls
per hour.
. There is a limit of 15,000 active indicators per tenant.

=== Permissions

One of the following permissions is required to call this API. To learn
more, including how to choose permissions, see link:apis-intro.md[Get
started]

[width="100%",cols="<34%,<33%,<33%",options="header",]
|===
|Permission type |Permission |Permission display name
|Application |Ti.ReadWrite |`Read and write Indicators'

|Application |Ti.ReadWrite.All |`Read and write All Indicators'

|Delegated (work or school account) |Ti.ReadWrite |`Read and write
Indicators'
|===

=== HTTP request

[source,http]
----
POST https://api.securitycenter.microsoft.com/api/indicators
----

=== Request headers

[cols="<,<,<",options="header",]
|===
|Name |Type |Description
|Authorization |String |Bearer \{token}. *Required*.
|Content-Type |string |application/json. *Required*.
|===

=== Request body

In the request body, supply a JSON object with the following parameters:

[width="100%",cols="<34%,<33%,<33%",options="header",]
|===
|Parameter |Type |Description
|indicatorValue |String |Identity of the link:ti-indicator.md[Indicator]
entity. *Required*

|indicatorType |Enum |Type of the indicator. Possible values are:
``FileSha1'', ``FileMd5'', ``CertificateThumbprint'', ``FileSha256'',
``IpAddress'', ``DomainName'' and ``Url''. *Required*

|action |Enum |The action that will be taken if the indicator will be
discovered in the organization. Possible values are: ``Alert'',
``Warn'', ``Block'', ``Audit,''BlockAndRemediate”, ``AlertAndBlock'',
and ``Allowed''. *Required*. The ``GenerateAlert'' parameter must be set
to ``TRUE'' when creating an action with ``Audit''.

|application |String |The application associated with the indicator.
This field only works for new indicators. It will not update the value
on an existing indicator. *Optional*

|description |String |Description of the indicator. *Required*

|expirationTime |DateTimeOffset |The expiration time of the indicator.
*Optional*

|severity |Enum |The severity of the indicator. Possible values are:
``Informational'', ``Low'', ``Medium'', and ``High''. *Optional*

|recommendedActions |String |TI indicator alert recommended actions.
*Optional*

|rbacGroupNames |String |Comma-separated list of RBAC group names the
indicator would be applied to. *Optional*

|educateUrl |String |Custom notification/support URL. Supported for
Block and Warn action types for URL indicators. *Optional*

|generateAlert |Enum |*True* if alert generation is required, *False* if
this indicator should not generate an alert.
|===

=== Response

* If successful, this method returns 200 - OK response code and the
created / updated link:ti-indicator.md[Indicator] entity in the response
body.
* If not successful: this method return 400 - Bad Request. Bad request
usually indicates incorrect body.

=== Example

==== Request

Here is an example of the request.

[source,http]
----
POST https://api.securitycenter.microsoft.com/api/indicators
----

[source,json]
----
{
    "indicatorValue": "220e7d15b011d7fac48f2bd61114db1022197f7f",
    "indicatorType": "FileSha1",
    "title": "test",
    "application": "demo-test",
    "expirationTime": "2020-12-12T00:00:00Z",
    "action": "AlertAndBlock",
    "severity": "Informational",
    "description": "test",
    "recommendedActions": "nothing",
    "rbacGroupNames": ["group1", "group2"]
}
----

=== Related topic

* link:manage-indicators.md[Manage indicators]
