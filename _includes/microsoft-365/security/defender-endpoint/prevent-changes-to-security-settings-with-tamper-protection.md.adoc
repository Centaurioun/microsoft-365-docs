= Protect security settings with tamper protection
:audience: ITPro
:author: denisebmsft
:description: Use tamper protection to prevent malicious apps from changing important security settings.
:keywords: malware, defender, antivirus, tamper protection
:manager: dansimp
:ms.author: deniseb
:ms.collection: ["M365-security-compliance", "m365initiative-defender-endpoint"]
:ms.custom: ["nextgen", "admindeeplinkDEFENDER"]
:ms.date: 09/23/2022
:ms.localizationpriority: medium
:ms.mktglfcycl: manage
:ms.pagetype: security
:ms.reviewer: mattcall, pahuijbr, hayhov, oogunrinde
:ms.service: microsoft-365-security
:ms.sitesec: library
:ms.subservice: mde
:ms.topic: conceptual
:search.appverid: met150

== Protect security settings with tamper protection

*Applies to:*

* https://go.microsoft.com/fwlink/p/?linkid=2154037[Microsoft Defender for Endpoint Plan 1]
* https://go.microsoft.com/fwlink/p/?linkid=2154037[Microsoft Defender for Endpoint Plan 2]
* Microsoft Defender Antivirus

*Platforms*

* Windows

Tamper protection is available for devices that are running one of the following versions of Windows:

* Windows 11
* Windows 11 Enterprise multi-session
* Windows 10
* Windows 10 Enterprise multi-session
* Windows Server 2022
* Windows Server 2019
* Windows Server, version 1803 or later
* Windows Server 2016
* Windows Server 2012 R2

____
[!NOTE] Tamper protection in Windows Server 2012 R2 is available for devices onboarded using the modern unified solution package.
For more information, see link:/microsoft-365/security/defender-endpoint/configure-server-endpoints[Onboard Windows servers to the Microsoft Defender for Endpoint service].
____

=== Overview

During some kinds of cyber attacks, bad actors try to disable security features, such as antivirus protection, on your machines.
Bad actors like to disable your security features to get easier access to your data, to install malware, or to otherwise exploit your data, identity, and devices.
Tamper protection helps prevent these kinds of things from occurring.
With tamper protection, malicious apps are prevented from taking actions such as:

* Disabling virus and threat protection
* Disabling real-time protection
* Turning off behavior monitoring
* Disabling antivirus protection, such as IOfficeAntivirus (IOAV)
* Disabling cloud-delivered protection
* Removing security intelligence updates
* Disabling automatic actions on detected threats
* Suppressing notifications in the Windows Security app
* Disabling scanning of archives and network files

____
[!IMPORTANT] Built-in protection (preview) includes turning tamper protection on by default.
To learn more about built-in protection, see:

* xref:built-in-protection.adoc[Built-in protection helps guard against ransomware] (article)
* https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/tamper-protection-will-be-turned-on-for-all-enterprise-customers/ba-p/3616478[Tamper protection will be turned on for all enterprise customers] (Tech Community blog post)
____

==== How it works

Tamper protection essentially locks Microsoft Defender Antivirus to its secure, default values, and prevents your security settings from being changed through apps and methods such as:

* Configuring settings in Registry Editor on your Windows device
* Changing settings through PowerShell cmdlets
* Editing or removing security settings through Group Policy

Tamper protection doesn't prevent you from viewing your security settings.
And, tamper protection doesn't affect how non-Microsoft antivirus apps register with the Windows Security app.
If your organization is using Windows 10 Enterprise E5, individual users can't change the tamper protection setting;
in those cases, tamper protection is managed by your security team.

==== What do you want to do?

|===
| To perform this task... | See this section...

| Manage tamper protection across your tenant <p> Use the Microsoft 365 Defender portal to turn tamper protection on or off
| xref:manage-tamper-protection-microsoft-365-defender.adoc[Manage tamper protection for your organization using Microsoft 365 Defender]

| Fine-tune tamper protection settings in your organization <p> Use Intune (Microsoft Endpoint Manager) to turn tamper protection on or off.
You can configure tamper protection for some or all users with this method.
| xref:manage-tamper-protection-microsoft-endpoint-manager.adoc[Manage tamper protection for your organization using Microsoft Endpoint Manager]

| Turn tamper protection on (or off) for your organization with Configuration Manager
| xref:manage-tamper-protection-configuration-manager.adoc[Manage tamper protection for your organization using tenant attach with Configuration Manager, version 2006]

| Turn tamper protection on (or off) for an individual device
| xref:manage-tamper-protection-individual-device.adoc[Manage tamper protection on an individual device]

| View details about tampering attempts on devices
| <<view-information-about-tampering-attempts,View information about tampering attempts>>

| Review your security recommendations
| <<review-your-security-recommendations,Review security recommendations>>

| Review the list of frequently asked questions (FAQs)
| xref:faqs-tamper-protection.adoc[Browse the FAQs]
|===

=== Potential dependency on cloud protection

Depending on the method or management tool you use to enable tamper protection, there might be a dependency on xref:cloud-protection-microsoft-defender-antivirus.adoc[cloud-delivered protection].
Cloud-delivered protection is also referred to as cloud protection, or Microsoft Advanced Protection Service (MAPS).

The following table provides details on the methods, tools, and dependencies.

|===
| How tamper protection is enabled | Dependency on cloud protection

| Microsoft Intune
| No

| Microsoft Endpoint Configuration Manager with Tenant Attach
| No

| Microsoft 365 Defender portal (https://security.microsoft.com)
| Yes
|===

=== Are you using Windows Server 2012 R2, 2016, or Windows version 1709, 1803, or 1809?

If you're using Windows Server 2012 R2 using the modern unified solution, Windows Server 2016, Windows 10 version 1709, 1803, or link:/windows/release-health/status-windows-10-1809-and-windows-server-2019[1809], you won't see *Tamper Protection* in the Windows Security app.
Instead, you can use PowerShell to determine whether tamper protection is enabled.

On Windows Server 2016, the Settings app won't accurately reflect the status of real-time protection when tamper protection is enabled.

==== Use PowerShell to determine whether tamper protection and real-time protection are turned on

. Open the Windows PowerShell app.
. Use the link:/powershell/module/defender/get-mpcomputerstatus?preserve-view=true&view=win10-ps[Get-MpComputerStatus] PowerShell cmdlet.
. In the list of results, look for `IsTamperProtected` or `RealTimeProtectionEnabled`.
(A value of _true_ means tamper protection is enabled.)

=== View information about tampering attempts

Tampering attempts typically indicate bigger cyberattacks.
Bad actors try to change security settings as a way to persist and stay undetected.
If you're part of your organization's security team, you can view information about such attempts, and then take appropriate actions to mitigate threats.

When a tampering attempt is detected, an alert is raised in the link:/microsoft-365/security/defender-endpoint/portal-overview[Microsoft 365 Defender portal] (https://security.microsoft.com).

Using xref:overview-endpoint-detection-response.adoc[endpoint detection and response] and xref:advanced-hunting-overview.adoc[advanced hunting] capabilities in Microsoft Defender for Endpoint, your security operations team can investigate and address such attempts.

=== Review your security recommendations

Tamper protection integrates with xref:next-gen-threat-and-vuln-mgt.adoc[Microsoft Defender Vulnerability Management] capabilities.
xref:tvm-security-recommendation.adoc[Security recommendations] include making sure tamper protection is turned on.
For example, you can search on _tamper_.
In the results, you can select *Turn on Tamper Protection* to learn more and turn it on.

To learn more about Microsoft Defender Vulnerability Management, see link:tvm-dashboard-insights.md#dashboard-insights---threat-and-vulnerability-management[Dashboard insights - Defender Vulnerability Management].

____
[!TIP] If you're looking for Antivirus related information for other platforms, see:

* xref:mac-preferences.adoc[Set preferences for Microsoft Defender for Endpoint on macOS]
* xref:microsoft-defender-endpoint-mac.adoc[Microsoft Defender for Endpoint on Mac]
* link:/mem/intune/protect/antivirus-microsoft-defender-settings-macos[macOS Antivirus policy settings for Microsoft Defender Antivirus for Intune]
* xref:linux-preferences.adoc[Set preferences for Microsoft Defender for Endpoint on Linux]
* xref:microsoft-defender-endpoint-linux.adoc[Microsoft Defender for Endpoint on Linux]
* xref:android-configure.adoc[Configure Defender for Endpoint on Android features]
* xref:ios-configure-features.adoc[Configure Microsoft Defender for Endpoint on iOS features]
____

=== See also

* link:/intune/help-secure-windows-pcs-with-endpoint-protection-for-microsoft-intune[Help secure Windows PCs with Endpoint Protection for Microsoft Intune]
* link:/microsoft-365/security/defender-endpoint[Get an overview of Microsoft Defender for Endpoint]
* xref:why-use-microsoft-defender-antivirus.adoc[Better together: Microsoft Defender Antivirus and Microsoft Defender for Endpoint]
* xref:enable-troubleshooting-mode.adoc[Enable troubleshooting mode]
* xref:troubleshooting-mode-scenarios.adoc[Troubleshooting mode scenarios]
