= 
denisebmsft
:keywords: mitigations, vulnerabilities, vulnerability, mitigation,
exploit, exploits, emet

== Protect devices from exploits

*Applies to:* -
https://go.microsoft.com/fwlink/?linkid=2154037[Microsoft Defender for
Endpoint Plan 2] -
https://go.microsoft.com/fwlink/?linkid=2118804[Microsoft 365 Defender]

Exploit protection automatically applies many exploit mitigation
techniques to operating system processes and apps. Exploit protection is
supported beginning with Windows 10, version 1709, Windows 11, and
Windows Server, version 1803.

Exploit protection works best with
link:microsoft-defender-endpoint.md[Defender for Endpoint] - which gives
you detailed reporting into exploit protection events and blocks as part
of the usual link:investigate-alerts.md[alert investigation scenarios].

You can link:enable-exploit-protection.md[enable exploit protection] on
an individual device, and then use
link:import-export-exploit-protection-emet-xml.md[Group Policy] to
distribute the XML file to multiple devices at once.

When a mitigation is found on the device, a notification will be
displayed from the Action Center. You can
link:attack-surface-reduction-rules-deployment-implement.md#customize-attack-surface-reduction-rules[customize
the notification] with your company details and contact information. You
can also enable the rules individually to customize what techniques the
feature monitors.

You can also use link:evaluate-exploit-protection.md[audit mode] to
evaluate how exploit protection would affect your organization if it
were enabled.

Many of the features in the
https://technet.microsoft.com/security/jj653751[Enhanced Mitigation
Experience Toolkit (EMET)] are included in exploit protection. In fact,
you can convert and import existing your EMET configuration profiles
into exploit protection. To learn more, see
link:/microsoft-365/security/defender-endpoint/import-export-exploit-protection-emet-xml[Import&#44;
export&#44; and deploy exploit protection configurations].

____
[!IMPORTANT] If you are currently using EMET you should be aware that
https://blogs.technet.microsoft.com/srd/2016/11/03/beyond-emet/[EMET
reached end of support on July 31&#44; 2018]. Consider replacing EMET with
exploit protection in Windows 10.
____

____
[!WARNING] Some security mitigation technologies may have compatibility
issues with some applications. You should test exploit protection in all
target use scenarios by using link:audit-windows-defender.md[audit mode]
before deploying the configuration across a production environment or
the rest of your network.
____

=== Review exploit protection events in the Microsoft 365 Defender portal

Defender for Endpoint provides detailed reporting into events and blocks
as part of its alert investigation scenarios.

You can query Defender for Endpoint data by using
link:/microsoft-365/security/defender-endpoint/advanced-hunting-overview[Advanced
hunting]. If you’re using link:audit-windows-defender.md[audit mode],
you can use advanced hunting to see how exploit protection settings
could affect your environment.

Here’s an example query:

[source,kusto]
----
DeviceEvents
| where ActionType startswith 'ExploitGuard' and ActionType !contains 'NetworkProtection'
----

=== Review exploit protection events in Windows Event Viewer

You can review the Windows event log to see events that are created when
exploit protection blocks (or audits) an app:

[cols="<,<,<",options="header",]
|===
|Provider/source |Event ID |Description
|Security-Mitigations |1 |ACG audit
|Security-Mitigations |2 |ACG enforce
|Security-Mitigations |3 |Don’t allow child processes audit
|Security-Mitigations |4 |Don’t allow child processes block
|Security-Mitigations |5 |Block low integrity images audit
|Security-Mitigations |6 |Block low integrity images block
|Security-Mitigations |7 |Block remote images audit
|Security-Mitigations |8 |Block remote images block
|Security-Mitigations |9 |Disable win32k system calls audit
|Security-Mitigations |10 |Disable win32k system calls block
|Security-Mitigations |11 |Code integrity guard audit
|Security-Mitigations |12 |Code integrity guard block
|Security-Mitigations |13 |EAF audit
|Security-Mitigations |14 |EAF enforce
|Security-Mitigations |15 |EAF+ audit
|Security-Mitigations |16 |EAF+ enforce
|Security-Mitigations |17 |IAF audit
|Security-Mitigations |18 |IAF enforce
|Security-Mitigations |19 |ROP StackPivot audit
|Security-Mitigations |20 |ROP StackPivot enforce
|Security-Mitigations |21 |ROP CallerCheck audit
|Security-Mitigations |22 |ROP CallerCheck enforce
|Security-Mitigations |23 |ROP SimExec audit
|Security-Mitigations |24 |ROP SimExec enforce
|WER-Diagnostics |5 |CFG Block
|Win32K |260 |Untrusted Font
|===

=== Mitigation comparison

The mitigations available in EMET are included natively in Windows 10
(starting with version 1709), Windows 11, and Windows Server (starting
with version 1803), under link:exploit-protection.md[Exploit
protection].

The table in this section indicates the availability and support of
native mitigations between EMET and exploit protection.

[width="100%",cols="<34%,<33%,<33%",options="header",]
|===
|Mitigation |Available under exploit protection |Available in EMET
|Arbitrary code guard (ACG) |Yes |YesAs ``Memory Protection Check''

|Block remote images |Yes |YesAs ``Load Library Check''

|Block untrusted fonts |Yes |Yes

|Data Execution Prevention (DEP) |Yes |Yes

|Export address filtering (EAF) |Yes |Yes

|Force randomization for images (Mandatory ASLR) |Yes |Yes

|NullPage Security Mitigation |YesIncluded natively in Windows 10 and
Windows 11 See
link:/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10#understanding-windows-10-in-relation-to-the-enhanced-mitigation-experience-toolkit[Mitigate
threats by using Windows 10 security features] for more information |Yes

|Randomize memory allocations (Bottom-Up ASLR) |Yes |Yes

|Simulate execution (SimExec) |Yes |Yes

|Validate API invocation (CallerCheck) |Yes |Yes

|Validate exception chains (SEHOP) |Yes |Yes

|Validate stack integrity (StackPivot) |Yes |Yes

|Certificate trust (configurable certificate pinning) |Windows 10 and
Windows 11 provide enterprise certificate pinning |Yes

|Heap spray allocation |Ineffective against newer browser-based
exploits; newer mitigations provide better protectionSee
link:/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10#understanding-windows-10-in-relation-to-the-enhanced-mitigation-experience-toolkit[Mitigate
threats by using Windows 10 security features] for more information |Yes

|Block low integrity images |Yes |No

|Code integrity guard |Yes |No

|Disable extension points |Yes |No

|Disable Win32k system calls |Yes |No

|Do not allow child processes |Yes |No

|Import address filtering (IAF) |Yes |No

|Validate handle usage |Yes |No

|Validate heap integrity |Yes |No

|Validate image dependency integrity |Yes |No
|===

____
{empty}[!NOTE]
____

____
The Advanced ROP mitigations that are available in EMET are superseded
by ACG in Windows 10 and Windows 11, which other EMET advanced settings
are enabled by default, as part of enabling the anti-ROP mitigations for
a process. See the
link:/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10#understanding-windows-10-in-relation-to-the-enhanced-mitigation-experience-toolkit[Mitigation
threats by using Windows 10 security features] for more information on
how Windows 10 employs existing EMET technology.
____

=== See also

* link:customize-exploit-protection.md[Configure and audit exploit
protection mitigations]
* link:troubleshoot-exploit-protection-mitigations.md[Troubleshoot
exploit protection]
* link:configure-machines-asr.md[Optimize ASR rule deployment and
detections]
