= 
denisebmsft
:keywords: Exploit protection, exploits, kernel, events, evaluate, demo,
try, mitigation

== Evaluate exploit protection

{empty}[!INCLUDE link:../../includes/microsoft-defender.md[Microsoft 365
Defender rebranding]]

*Applies to:* -
https://go.microsoft.com/fwlink/?linkid=2154037[Microsoft Defender for
Endpoint Plan 1] -
https://go.microsoft.com/fwlink/?linkid=2154037[Microsoft Defender for
Endpoint Plan 2] -
https://go.microsoft.com/fwlink/?linkid=2118804[Microsoft 365 Defender]

____
Want to experience Microsoft Defender for Endpoint?
https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-enablesiem-abovefoldlink[Sign
up for a free trial.]
____

link:exploit-protection.md[Exploit protection] helps protect devices
from malware that uses exploits to spread and infect other devices.
Mitigation can be applied to either the operating system or to an
individual app. Many of the features that were part of the Enhanced
Mitigation Experience Toolkit (EMET) are included in exploit protection.
(The EMET has reached its end of support.)

In audit, you can see how mitigation works for certain apps in a test
environment. This shows what _would_ have happened if you enabled
exploit protection in your production environment. This way, you can
verify that exploit protection doesn’t adversely affect your
line-of-business apps, and see which suspicious or malicious events
occur.

=== Enable exploit protection for testing

You can set mitigations in a testing mode for specific programs by using
the Windows Security app or Windows PowerShell.

==== Windows Security app

[arabic]
. Open the Windows Security app. Select the shield icon in the task bar
or search the start menu for *Windows Security*.
. Select the *App & browser control* tile (or the app icon on the left
menu bar) and then select *Exploit protection*.
. Go to *Program settings* and choose the app you want to apply
protection to:
[arabic]
.. If the app you want to configure is already listed, select it and
then select *Edit*
.. If the app is not listed at the top of the list select *Add program
to customize*. Then, choose how you want to add the app.
* Use *Add by program name* to have the mitigation applied to any
running process with that name. Specify a file with an extension. You
can enter a full path to limit the mitigation to only the app with that
name in that location.
* Use *Choose exact file path* to use a standard Windows Explorer file
picker window to find and select the file you want.
. After selecting the app, you’ll see a list of all the mitigations that
can be applied. Choosing *Audit* will apply the mitigation in test mode
only. You’ll be notified if you need to restart the process, app, or
Windows.
. Repeat this procedure for all the apps and mitigations you want to
configure. Select *Apply* when you’re done setting up your
configuration.

==== PowerShell

To set app-level mitigations to test mode, use `Set-ProcessMitigation`
with the *Audit mode* cmdlet.

Configure each mitigation in the following format:

[source,powershell]
----
Set-ProcessMitigation -<scope> <app executable> -<action> <mitigation or options>,<mitigation or options>,<mitigation or options>
----

Where:

* <Scope>:
** `-Name` to indicate the mitigations should be applied to a specific
app. Specify the app’s executable after this flag.
* <Action>:
** `-Enable` to enable the mitigation
*** `-Disable` to disable the mitigation
* <Mitigation>:
** The mitigation’s cmdlet as defined in the following table. Each
mitigation is separated with a comma.

[cols=",",options="header",]
|===
|Mitigation |Test mode cmdlet
|Arbitrary Code Guard (ACG) |`AuditDynamicCode`
|Block low integrity images |`AuditImageLoad`
|Block untrusted fonts |`AuditFont`, `FontAuditOnly`
|Code integrity guard |`AuditMicrosoftSigned`, `AuditStoreSigned`
|Disable Win32k system calls |`AuditSystemCall`
|Do not allow child processes |`AuditChildProcess`
|===

For example, to enable Arbitrary Code Guard (ACG) in test mode for an
app named _testing.exe_, run the following command:

[source,powershell]
----
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable AuditDynamicCode
----

You can disable *audit mode* by replacing `-Enable` with `-Disable`.

=== Review exploit protection audit events

To review which apps would have been blocked, open Event Viewer and
filter for the following events in the Security-Mitigations log.

[width="100%",cols="28%,27%,18%,27%",options="header",]
|===
|Feature |Provider/source |Event ID |Description
|Exploit protection |Security-Mitigations (Kernel Mode/User Mode) |1
|ACG audit

|Exploit protection |Security-Mitigations (Kernel Mode/User Mode) |3 |Do
not allow child processes audit

|Exploit protection |Security-Mitigations (Kernel Mode/User Mode) |5
|Block low integrity images audit

|Exploit protection |Security-Mitigations (Kernel Mode/User Mode) |7
|Block remote images audit

|Exploit protection |Security-Mitigations (Kernel Mode/User Mode) |9
|Disable win32k system calls audit

|Exploit protection |Security-Mitigations (Kernel Mode/User Mode) |11
|Code integrity guard audit
|===

=== See also

* link:enable-exploit-protection.md[Enable exploit protection]
* link:customize-exploit-protection.md[Configure and audit exploit
protection mitigations]
* link:import-export-exploit-protection-emet-xml.md[Import&#44; export&#44; and
deploy exploit protection configurations]
* link:troubleshoot-exploit-protection-mitigations.md[Troubleshoot
exploit protection]
