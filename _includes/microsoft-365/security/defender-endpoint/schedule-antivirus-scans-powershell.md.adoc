= Schedule antivirus scans using PowerShell
:author: denisebmsft
:description: Schedule antivirus scans using PowerShell
:keywords: quick scan, full scan, antivirus, schedule, PowerShell
:manager: dansimp
:ms.author: deniseb
:ms.collection: M365-security-compliance
:ms.custom: nextgen
:ms.date: 10/18/2021
:ms.localizationpriority: medium
:ms.mktglfcycl: manage
:ms.pagetype: security
:ms.reviewer: pauhijbr, ksarens
:ms.service: microsoft-365-security
:ms.sitesec: library
:ms.subservice: mde
:ms.topic: how-to
:search.appverid: met150

== Schedule antivirus scans using PowerShell

*Applies to:*

* https://go.microsoft.com/fwlink/?linkid=2154037[Microsoft Defender for Endpoint Plan 1]
* https://go.microsoft.com/fwlink/?linkid=2154037[Microsoft Defender for Endpoint Plan 2]
* Microsoft Defender Antivirus

*Platforms*

* Windows

This article describes how to configure scheduled scans using PowerShell cmdlets.
To learn more about scheduling scans and about scan types, see xref:schedule-antivirus-scans.adoc[Configure scheduled quick or full Microsoft Defender Antivirus scans].

=== Use PowerShell cmdlets to schedule scans

Use the following cmdlets:

[,powershell]
----
Set-MpPreference -ScanParameters
Set-MpPreference -ScanScheduleDay
Set-MpPreference -ScanScheduleTime
Set-MpPreference -RandomizeScheduleTaskTimes
----

For more information, see xref:use-powershell-cmdlets-microsoft-defender-antivirus.adoc[Use PowerShell cmdlets to configure and run Microsoft Defender Antivirus] and link:/powershell/module/defender/[Defender Antivirus cmdlets] for more information on how to use PowerShell with Microsoft Defender Antivirus.

=== PowerShell cmdlets for scheduling scans when an endpoint is not in use

Use the following cmdlets:

[,powershell]
----
Set-MpPreference -ScanOnlyIfIdleEnabled
----

For more information, see xref:use-powershell-cmdlets-microsoft-defender-antivirus.adoc[Use PowerShell cmdlets to configure and run Microsoft Defender Antivirus] and link:/powershell/module/defender/[Defender Antivirus cmdlets].

____
[!NOTE] When you schedule scans for times when endpoints are not in use, scans do not honor the CPU throttling configuration and will take full advantage of the resources available to complete the scan as fast as possible.
____

=== PowerShell cmdlets for scheduling scans to complete remediation

Use the following cmdlets:

[,powershell]
----
Set-MpPreference -RemediationScheduleDay
Set-MpPreference -RemediationScheduleTime
----

See xref:use-powershell-cmdlets-microsoft-defender-antivirus.adoc[Use PowerShell cmdlets to configure and run Microsoft Defender Antivirus] and link:/powershell/module/defender/[Defender Antivirus cmdlets] for more information on how to use PowerShell with Microsoft Defender Antivirus.

=== PowerShell cmdlets for scheduling daily scans

Use the following cmdlets:

[,powershell]
----
Set-MpPreference -ScanScheduleQuickScanTime
----

For more information about how to use PowerShell with Microsoft Defender Antivirus, see xref:use-powershell-cmdlets-microsoft-defender-antivirus.adoc[Use PowerShell cmdlets to configure and run Microsoft Defender Antivirus] and link:/powershell/module/defender/[Defender Antivirus cmdlets].

____
[!TIP] If you're looking for Antivirus related information for other platforms, see:

* xref:mac-preferences.adoc[Set preferences for Microsoft Defender for Endpoint on macOS]
* xref:microsoft-defender-endpoint-mac.adoc[Microsoft Defender for Endpoint on Mac]
* link:/mem/intune/protect/antivirus-microsoft-defender-settings-macos[macOS Antivirus policy settings for Microsoft Defender Antivirus for Intune]
* xref:linux-preferences.adoc[Set preferences for Microsoft Defender for Endpoint on Linux]
* xref:microsoft-defender-endpoint-linux.adoc[Microsoft Defender for Endpoint on Linux]
* xref:android-configure.adoc[Configure Defender for Endpoint on Android features]
* xref:ios-configure-features.adoc[Configure Microsoft Defender for Endpoint on iOS features]
____
