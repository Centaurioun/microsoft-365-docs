= 
kelleyvice-msft

== Create Microsoft 365 user accounts with PowerShell

_This article applies to both Microsoft 365 Enterprise and Office 365
Enterprise._

You can use PowerShell for Microsoft 365 to efficiently create user
accounts, including multiple accounts.

When you create user accounts in PowerShell, certain account properties
are always required. Other properties aren’t required but are important.
See the following table.

[width="100%",cols="<34%,<33%,<33%",options="header",]
|===
|*Property name* |*Required?* |*Description*
|*DisplayName* |Yes |This is the display name that’s used in Microsoft
365 services. For example, _Caleb Sills_.

|*UserPrincipalName* |Yes |This is the account name that’s used to sign
in to Microsoft 365 services. For example,
_CalebS@contoso.onmicrosoft.com_.

|*FirstName* |No |

|*LastName* |No |

|*LicenseAssignment* |No |This is the licensing plan (also known as the
link:/azure/active-directory/enterprise-users/licensing-service-plan-reference[license
plan or SKU]) from which an available license is assigned to the user
account. The license defines the Microsoft 365 services that are
available to the account. You don’t have to assign a license to a user
when you create the account, but the account must have a license to
access Microsoft 365 services. You have 30 days to license the user
account after you create it.

|*Password* |No |If you don’t specify a password, a random password is
assigned to the user account, and the password is visible in the results
of the command. If you specify a password, it needs to be 8 to 16 ASCII
text characters of the following types: lowercase letters, uppercase
letters, numbers, and symbols.

|*UsageLocation* |No |This is a valid ISO 3166-1 alpha-2 country code.
For example, _US_ for the United States, and _FR_ for France. It’s
important to provide this value, because some Microsoft 365 services
aren’t available in certain countries. You can’t assign a license to a
user account unless the account has this value configured. For more
information, see https://go.microsoft.com/fwlink/p/?LinkId=691730[About
license restrictions].
|===

____
[!Note] link:../admin/add-users/add-users.md[Learn how to create user
accounts] by using the Microsoft 365 admin center.

For a list of additional resources, see link:/admin[Manage users and
groups].
____

=== Use the Azure Active Directory PowerShell for Graph module

First,
link:connect-to-microsoft-365-powershell.md#connect-with-the-azure-active-directory-powershell-for-graph-module[connect
to your Microsoft 365 tenant].

After you connect, use the following syntax to create an individual
account:

[source,powershell]
----
$PasswordProfile=New-Object -TypeName Microsoft.Open.AzureAD.Model.PasswordProfile
$PasswordProfile.Password="<user account password>"
New-AzureADUser -DisplayName "<display name>" -GivenName "<first name>" -SurName "<last name>" -UserPrincipalName <sign-in name> -UsageLocation <ISO 3166-1 alpha-2 country code> -MailNickName <mailbox name> -PasswordProfile $PasswordProfile -AccountEnabled $true
----

This example creates an account for the US user _Caleb Sills_:

[source,powershell]
----
$PasswordProfile=New-Object -TypeName Microsoft.Open.AzureAD.Model.PasswordProfile
$PasswordProfile.Password="3Rv0y1q39/chsy"
New-AzureADUser -DisplayName "Caleb Sills" -GivenName "Caleb" -SurName "Sills" -UserPrincipalName calebs@contoso.onmicrosoft.com -UsageLocation US -MailNickName calebs -PasswordProfile $PasswordProfile -AccountEnabled $true
----

=== Use the Microsoft Azure Active Directory Module for Windows PowerShell

First,
link:connect-to-microsoft-365-powershell.md#connect-with-the-microsoft-azure-active-directory-module-for-windows-powershell[connect
to your Microsoft 365 tenant].

==== Create an individual user account

To create an individual account, use the following syntax:

[source,powershell]
----
New-MsolUser -DisplayName <display name> -FirstName <first name> -LastName <last name> -UserPrincipalName <sign-in name> -UsageLocation <ISO 3166-1 alpha-2 country code> -LicenseAssignment <licensing plan name> [-Password <Password>]
----

____
[!Note] PowerShell Core doesn’t support the Microsoft Azure Active
Directory Module for Windows PowerShell module and cmdlets that have
_Msol_ in their name. Run these cmdlets from Windows PowerShell.
____

To list the available
link:/azure/active-directory/enterprise-users/licensing-service-plan-reference[licensing
plan names], use this command:

[source,powershell]
----
Get-MsolAccountSku
----

This example creates an account for the US user _Caleb Sills_, and
assigns a license from the `contoso:ENTERPRISEPACK` (Office 365
Enterprise E3) licensing plan.

[source,powershell]
----
New-MsolUser -DisplayName "Caleb Sills" -FirstName Caleb -LastName Sills -UserPrincipalName calebs@contoso.onmicrosoft.com -UsageLocation US -LicenseAssignment contoso:ENTERPRISEPACK
----

==== Create multiple user accounts

[arabic]
. Create a comma-separated value (CSV) file that contains the required
user account information. For example:
+
[source,powershell]
----
UserPrincipalName,FirstName,LastName,DisplayName,UsageLocation,AccountSkuId
ClaudeL@contoso.onmicrosoft.com,Claude,Loiselle,Claude Loiselle,US,contoso:ENTERPRISEPACK
LynneB@contoso.onmicrosoft.com,Lynne,Baxter,Lynne Baxter,US,contoso:ENTERPRISEPACK
ShawnM@contoso.onmicrosoft.com,Shawn,Melendez,Shawn Melendez,US,contoso:ENTERPRISEPACK
----
+
____
[!NOTE] The column names and their order in the first row of the CSV
file are arbitrary. But make sure the order of the data in the rest of
the file matches the order of the column names. And use the column names
for the parameter values in the PowerShell for Microsoft 365 command.
____
. Use the following syntax:
+
[source,powershell]
----
 Import-Csv -Path <Input CSV File Path and Name> | foreach {New-MsolUser -DisplayName $_.DisplayName -FirstName $_.FirstName -LastName $_.LastName -UserPrincipalName $_.UserPrincipalName -UsageLocation $_.UsageLocation -LicenseAssignment $_.AccountSkuId [-Password $_.Password]} | Export-Csv -Path <Output CSV File Path and Name>
----
+
This example creates user accounts from the file _C:Documents.csv_ and
logs the results in a file named _C:Documents.csv_.
+
[source,powershell]
----
Import-Csv -Path "C:\My Documents\NewAccounts.csv" | foreach {New-MsolUser -DisplayName $_.DisplayName -FirstName $_.FirstName -LastName $_.LastName -UserPrincipalName $_.UserPrincipalName -UsageLocation $_.UsageLocation -LicenseAssignment $_.AccountSkuId} | Export-Csv -Path "C:\My Documents\NewAccountResults.csv"
----
. Review the output file to see the results. We didn’t specify
passwords, so the random passwords that Microsoft 365 generated are
visible in the output file.

=== See also

link:manage-user-accounts-and-licenses-with-microsoft-365-powershell.md[Manage
Microsoft 365 user accounts&#44; licenses&#44; and groups with PowerShell]

link:manage-microsoft-365-with-microsoft-365-powershell.md[Manage
Microsoft 365 with PowerShell]

link:getting-started-with-microsoft-365-powershell.md[Getting started
with PowerShell for Microsoft 365]
