= Manage Microsoft 365 Groups with PowerShell
:audience: Admin
:author: MikePlumleyMSFT
:description: In this article, learn how to do common management tasks for Microsoft 365 groups in PowerShell.
:f1.keywords: ["CSH"]
:manager: pamgreen
:ms.assetid: aeb669aa-1770-4537-9de2-a82ac11b0540
:ms.author: mikeplum
:ms.custom: ["Adm_O365", "seo-marvel-apr2020", "admindeeplinkMAC", "admindeeplinkEXCHANGE"]
:ms.localizationpriority: medium
:ms.service: microsoft-365-enterprise
:ms.topic: article
:search.appverid: ["MET150", "MOE150", "MED150", "MBS150", "BSA160", "BCS160"]

== Manage Microsoft 365 Groups with PowerShell

_This article applies to both Microsoft 365 Enterprise and Office 365 Enterprise._

This article provides the steps for doing common management tasks for Groups in Microsoft PowerShell.
It also lists the PowerShell cmdlets for Groups.
For info about managing SharePoint sites, see link:/sharepoint/manage-team-and-communication-sites-in-powershell[Manage SharePoint Online sites using PowerShell].

=== Link to your Microsoft 365 Groups usage guidelines

When users https://support.office.com/article/04d0c9cf-6864-423c-a380-4fa858f27102.aspx[create or edit a group in Outlook], you can show them a link to your organization's usage guidelines.
For example, if you require a specific prefix or suffix to be added to a group name.

Use the Azure Active Directory (Azure AD) PowerShell to point your users to your organization's usage guidelines for Microsoft 365 groups.
Check out link:/azure/active-directory/enterprise-users/groups-settings-cmdlets[Azure Active Directory cmdlets for configuring group settings] and follow the steps in the *Create settings at the directory level* to define the usage guideline hyperlink.
Once you run the AAD cmdlet, users will see the link to your guidelines when they create or edit a group in Outlook.

image::../media/3f74463f-3448-4f24-a0ec-086d9aa95caa.png[Create a new group with usage guidelines link.]

image::../media/d0d54ace-f0ec-4946-b2de-50ce23f17765.png[Click Group usage guidelines to see your organizations Office 365 groups guidelines.]

=== Allow users to Send as the Microsoft 365 Group

If you want to enable your Microsoft 365 groups to "Send As", use the link:/powershell/module/exchange/add-recipientpermission[Add-RecipientPermission] and link:/powershell/module/exchange/get-recipientpermission[Get-RecipientPermission] cmdlets to configure this.
Once you enable this setting, Microsoft 365 group users can use Outlook or Outlook on the web to send and reply to email as the Microsoft 365 group.
Users can go to the group, create a new email, and change the "Send As" field to the group's email address.

(link:/office365/admin/create-groups/allow-members-to-send-as-or-send-on-behalf-of-group[You can also do this in the Exchange Admin Center].)

Use the following script, replacing _<GroupAlias>_ with the alias of the group that you want to update, and _<UserAlias>_ with the alias of the user to whom you want to grant permissions.
link:/powershell/exchange/connect-to-exchange-online-powershell[Connect to Exchange Online PowerShell] to run this script.

[,powershell]
----
$groupAlias = "<GroupAlias>"
$userAlias = "<UserAlias>"
$groupsRecipientDetails = Get-Recipient -RecipientTypeDetails groupmailbox -Identity $groupAlias

Add-RecipientPermission -Identity $groupsRecipientDetails.Name -Trustee $userAlias -AccessRights SendAs
----

Once the cmdlet is executed, users can go to Outlook or Outlook on the web to send as the group, by adding the group email address to the *From* field.

=== Create classifications for Microsoft 365 Groups in your organization

You can create sensitivity labels that the users in your organization can set when they create a Microsoft 365 Group.
If you want to classify groups, we recommend using sensitivity labels instead of the previous groups classification feature.
For information about using sensitivity labels, see xref:../compliance/sensitivity-labels-teams-groups-sites.adoc[Use sensitivity labels to protect content in Microsoft Teams, Microsoft 365 groups, and SharePoint sites].

____
[!IMPORTANT] If you are currently using classification labels, they will no longer be available to users who create groups once sensitivity labels are enabled.
____

You can still use the previous groups classification feature.
You can create classifications that the users in your organization can set when they create a Microsoft 365 Group.
For example, you can allow users to set "Standard", "Secret", and "Top Secret" on groups they create.
Group classifications aren't set by default and you need to create it in order for your users to set it.
Use Azure Active Directory PowerShell to point your users to your organization's usage guidelines for Microsoft 365 Groups.

Check out link:/azure/active-directory/users-groups-roles/groups-settings-cmdlets[Azure Active Directory cmdlets for configuring group settings] and follow the steps in the *Create settings at the directory level* to define the classification for Microsoft 365 Groups.

[,powershell]
----
$setting["ClassificationList"] = "Low Impact, Medium Impact, High Impact"
----

In order to associate a description to each classification, you can use the settings attribute  _ClassificationDescriptions_ to define.

[,powershell]
----
$setting["ClassificationDescriptions"] ="Classification:Description,Classification:Description"
----

Where Classification matches the strings in the ClassificationList.

Example:

[,powershell]
----
$setting["ClassificationDescriptions"] = "Low Impact: General communication, Medium Impact: Company internal data , High Impact: Data that has regulatory requirements"
----

After you run the above Azure Active Directory cmdlet to set your classification, run the link:/powershell/module/exchange/Set-UnifiedGroup[Set-UnifiedGroup] cmdlet if you want to set the classification for a specific group.

[,powershell]
----
Set-UnifiedGroup <LowImpactGroup@constoso.com> -Classification <LowImpact>
----

Or create a new group with a classification.

[,powershell]
----
New-UnifiedGroup <HighImpactGroup@constoso.com> -Classification <HighImpact> -AccessType <Public>
----

Check out link:/powershell/exchange/exchange-online-powershell[Using PowerShell with Exchange Online] and link:/powershell/exchange/connect-to-exchange-online-powershell[Connect to Exchange Online PowerShell] for more details on using Exchange Online PowerShell.

Once these settings are enabled, the group owner will be able to choose a classification from the drop down menu in Outlook on the Web and Outlook, and save it from the *Edit* group page.

image::../media/f8d4219a-6180-491d-b0e1-4313ac83998b.png[Choose Microsoft 365 Group classification.]

=== Hide Microsoft 365 Groups from the global address list.

You can specify whether a Microsoft 365 Group appears in the global address list (GAL) and other lists in your organization.
For example, if you have a legal department group that you don't want to show up in the address list, you can stop that group from appearing in the GAL.
Run the Set-Unified Group cmdlet to hide the group from the address list like this:

[,powershell]
----
Set-UnifiedGroup -Identity "Legal Department" -HiddenFromAddressListsEnabled $true
----

=== Allow only internal users to send message to Microsoft 365 Groups

If you don't want users from other organizations to send emails to a Microsoft 365 Group, you can change the settings for that group.
It will allow only internal users to send an email to your group.
If an external user tries to send a message to that group, it will be rejected.

Run the Set-UnifiedGroup cmdlet to update this setting, like this:

[,powershell]
----
Set-UnifiedGroup -Identity "Internal senders only" -RequireSenderAuthenticationEnabled $true
----

=== Add MailTips to Microsoft 365 Groups

Whenever a sender tries to send an email to a Microsoft 365 Group, a MailTip can be shown to them.

Run the Set-Unified Group cmdlet to add a mailTip to the group:

[,powershell]
----
Set-UnifiedGroup -Identity "MailTip Group" -MailTip "This group has a MailTip"
----

Along with MailTip, you can also set MailTipTranslations, which specify other languages for the MailTip.
Suppose you want to have the Spanish translation, then run the following command:

[,powershell]
----
Set-UnifiedGroup -Identity "MailaTip Group" -MailTip "This group has a MailTip" -MailTipTranslations "@{Add="ES:Esta caja no se supervisa."
----

=== Change the display name of the Microsoft 365 Group

The display name specifies the name of the Microsoft 365 Group.
You can see this name in your https://go.microsoft.com/fwlink/p/?linkid=2059104[Exchange admin center] or https://go.microsoft.com/fwlink/p/?linkid=2024339[Microsoft 365 admin center].
You can edit the display name of the group or assign a display name to an existing Microsoft 365 Group by running the Set-UnifiedGroup command:

[,powershell]
----
Set-UnifiedGroup -Identity "mygroup@contoso.com" -DisplayName "My new group"
----

=== Change the default setting of Microsoft 365 Groups for Outlook to Public or Private

Microsoft 365 Groups in Outlook are created as Private by default.
If your organization wants Microsoft 365 Groups to be created as Public by default (or back to Private), use this PowerShell cmdlet syntax:

[,powershell]
----
 Set-OrganizationConfig -DefaultGroupAccessType Public
----

To set to Private:

[,powershell]
----
 Set-OrganizationConfig -DefaultGroupAccessType Private
----

To verify the setting:

[,powershell]
----
 Get-OrganizationConfig | ft DefaultGroupAccessType
----

To learn more, see link:/powershell/module/exchange/set-organizationconfig[Set-OrganizationConfig] and link:/powershell/module/exchange/get-organizationconfig[Get-OrganizationConfig].

=== Microsoft 365 Groups cmdlets

The following cmdlets can be used with Microsoft 365 Groups.

|===
| *Cmdlet name* | *Description*

| link:/powershell/module/exchange/get-unifiedgroup[Get-UnifiedGroup] +
| Use this cmdlet to look up existing Microsoft 365 Groups, and to view properties of the group object  +

| link:/powershell/module/exchange/set-unifiedgroup[Set-UnifiedGroup] +
| Update the properties of a specific Microsoft 365 Group  +

| link:/powershell/module/exchange/new-unifiedgroup[New-UnifiedGroup] +
| Create a new Microsoft 365 Group.
This cmdlet provides a minimal set of parameters.
To set values for extended properties, use Set-UnifiedGroup after creating the new group  +

| link:/powershell/module/exchange/remove-unifiedgroup[Remove-UnifiedGroup] +
| Delete an existing Microsoft 365 Group  +

| link:/powershell/module/exchange/get-unifiedgrouplinks[Get-UnifiedGroupLinks] +
| Retrieve membership and owner information for a Microsoft 365 Group  +

| link:/powershell/module/exchange/add-unifiedgrouplinks[Add-UnifiedGroupLinks] +
| Add members, owners, and subscribers to an existing Microsoft 365 Group +

| link:/powershell/module/exchange/remove-unifiedgrouplinks[Remove-UnifiedGroupLinks] +
| Remove owners and members from an existing Microsoft 365 Group  +

| link:/powershell/module/exchange/get-userphoto[Get-UserPhoto] +
| Used to view information about the user photo associated with an account.
User photos are stored in Active Directory  +

| link:/powershell/module/exchange/set-userphoto[Set-UserPhoto] +
| Used to associate a user photo with an account.
User photos are stored in Active Directory  +

| link:/powershell/module/exchange/remove-userphoto[Remove-UserPhoto] +
| Remove the photo for a Microsoft 365 Group  +
|===

=== Related topics

link:/office365/admin/manage/upgrade-distribution-lists[Upgrade distribution lists to Microsoft 365 Groups]

link:/office365/admin/create-groups/manage-creation-of-groups[Manage who can create Microsoft 365 Groups]

https://support.office.com/article/bfc7a840-868f-4fd6-a390-f347bf51aff6[Manage guest access to Microsoft 365 Groups]

link:/azure/active-directory/users-groups-roles/groups-change-type[Change static group membership to dynamic in]
