= 
kelleyvice-msft

== User Testing in Multi-Geo

In Azure Active Directory (Azure AD) there are two types of user
objects: cloud only users and synchronized users. Please follow the
appropriate instructions for your type of user.

____
[!TIP] We recommend that you begin validations with a test user or small
group of users before rolling out multi-geo to your broader
organization.
____

=== Synchronize user’s Preferred Data Location using Azure AD Connect

If your company’s users are synchronized from an on-premises Active
Directory system to Azure AD, their PreferredDataLocation must be
populated in AD and synchronized to Azure AD.

Follow the process in Azure Active Directory Connect sync: Configure
preferred data location for Microsoft 365 resources to configure
Preferred Data Location sync from your on-premises Active Directory
Domain Services (AD DS) to Azure AD.

We recommend that you include setting the user’s Preferred Data Location
as a part of your standard user creation workflow.

____
[!IMPORTANT] For new users with no OneDrive provisioned, license the
account and wait at least 48 hours after a user’s PDL is synchronized to
Azure AD for the changes to propagate before the user logs in to
OneDrive for Business. (Setting the preferred data location before the
user logs in to provision their OneDrive for Business ensures that the
user’s new OneDrive will be provisioned in the correct location.)
____

=== Setting Preferred Data Location for cloud only users

If your company’s users are not synchronized from an on-premises Active
Directory system to Azure AD, meaning they are created in Microsoft 365
or Azure AD, then the PDL must be set using the Microsoft Azure Active
Directory Module for Windows PowerShell.

The procedures in this section require the Microsoft Azure Active
Directory Module for Windows PowerShell Module. If you already have this
module installed, please ensure you update to the latest version.

link:connect-to-microsoft-365-powershell.md[Connect and sign in] with a
set of global administrator credentials for your _Tenant_.

Use the link:/powershell/module/msonline/set-msoluser[Set-MsolUser]
cmdlet to set the preferred data location for each of your users. For
example:

[source,powershell]
----
Set-MsolUser -UserPrincipalName Robyn.Buckley@Contoso.com -PreferredDatalocation EUR
----

You can check to confirm that the preferred data location was updated
properly by using the Get-MsolUser cmdlet. For example:

[source,powershell]
----
Get-MsolUser -UserPrincipalName Robyn.Buckley@Contoso.com.PreferredDatalocation
----

We recommend that you include setting the user’s Preferred Data Location
as a part of your standard user creation workflow.

____
[!IMPORTANT] or new users with no OneDrive provisioned, license the
account and wait at least 48 hours after a user’s PDL is set for the
changes to propagate before the user logs in to OneDrive. (Setting the
preferred data location before the user logs in to provision their
OneDrive for Business ensures that the user’s new OneDrive will be
provisioned in the correct location.)
____

=== OneDrive for Business Provisioning and the effect of PDL

If the user already has a OneDrive for Business site created in the
_Tenant_, setting their PDL will not automatically move their existing
OneDrive. To move a user’s OneDrive, see
link:move-onedrive-between-geo-locations.md[OneDrive for Business Geo
Move].

____
[!NOTE] Exchange Online automatically relocates the user’s mailbox if
the PLD changes and the MailboxRegion no longer matches the Mailbox
Database Geo Location code. For more information, see
link:administering-exchange-online-multi-geo.md[Administering Exchange
Online mailboxes in a multi-geo environment].
____

If the user does not have a OneDrive for Business site within the
_Tenant_, OneDrive for Business will be provisioned for them in
accordance to their PDL value, assuming the PDL for the user matches one
of the company’s satellite locations.
